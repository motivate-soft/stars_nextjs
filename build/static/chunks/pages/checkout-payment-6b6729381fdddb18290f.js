_N_E=(window.webpackJsonp_N_E=window.webpackJsonp_N_E||[]).push([[66],{"7Sp7":function(e,t,n){"use strict";var r=n("q1tI"),o=n.n(r),a=n("EDUr"),i=o.a.createElement;t.a=function(e){return i(a.a,null,i("svg",{className:"isoContentLoader",viewBox:"0 0 50 50"},i("circle",{className:"isoContentLoaderCircle",cx:"25",cy:"25",r:"20",fill:"none",strokeWidth:"3.6"})))}},EDUr:function(e,t,n){"use strict";var r=n("vOnD"),o=n("Bk8I"),a=r.d.div.withConfig({displayName:"loaderstyle__LoaderComponent",componentId:"sc-1pxv3ii-0"})(["width:100%;height:100%;display:flex;align-items:center;justify-content:center;position:absolute;z-index:10000000000;top:0;right:0;@media only screen and (min-width:768px) and (max-width:1220px){width:calc(100% - 80px);}@media only screen and (max-width:767px){width:100%;}.isoContentLoader{width:50px;height:50px;animation:svgSpinner 1.4s linear infinite;}.isoContentLoaderCircle{animation:svgSpinnerCircle 1.4s ease-in-out infinite;stroke-dasharray:80px,200px;stroke-dashoffset:0px;stroke:",";stroke-linecap:round;}@keyframes svgSpinner{100%{transform:rotate(360deg);}}@keyframes svgSpinnerCircle{0%{stroke-dasharray:1px,200px;stroke-dashoffset:0px;}50%{stroke-dasharray:100px,200px;stroke-dashoffset:-15px;}100%{stroke-dasharray:100px,200px;stroke-dashoffset:-120px;}}"],Object(o.palette)("primary",0));t.a=a},FHed:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/checkout-payment",function(){return n("GhS2")}])},GhS2:function(e,t,n){"use strict";n.r(t),n.d(t,"__N_SSG",(function(){return F})),n.d(t,"default",(function(){return L}));var r=n("q1tI"),o=n.n(r),a=n("8Kt/"),i=n.n(a),c=n("mq74"),u=n("9xET"),s=n.n(u),l=n("ZPTe"),p=n.n(l),d=n("o0o1"),f=n.n(d),y=n("rePB"),h=n("HaE+"),m=n("YFqc"),b=n.n(m),g=n("iDsv"),v=n("Wasw"),w=n("vOnD"),O=n("YEJx"),_=n("gNcs"),k=n("t9tb"),P=n("EDUr"),S=n("k0Xt"),x=n("OKMn"),j=n("Ye+W"),E=n("wd/R"),C=n.n(E),D=n("nOHt"),N=n("0b+E"),I=o.a.createElement;function R(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function B(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?R(Object(n),!0).forEach((function(t){Object(y.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):R(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var T=w.d.div.withConfig({displayName:"CheckoutPayment__CheckoutPaymentWrapper",componentId:"rqryvw-0"})([".checkout-payment-block{padding:50px 0 100px;h3{color:",";}span{font-size:16px;}}"],Object(O.a)("primary",0));var Y=function(e){var t=Object(r.useState)(!0),o=t[0],a=t[1],i=Object(r.useContext)(k.a),c=i.state,u=i.dispatch,l=Object(D.useRouter)(),d=function(){var e=Object(h.a)(f.a.mark((function e(){var t,r,o;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={bookerville_id:c.bookervilleId,checkin_date:C()(c.checkinDate).format("YYYY-MM-DD"),checkout_date:C()(c.checkoutDate).format("YYYY-MM-DD"),adults:c.adults,children:""===c.children?0:c.children,property_fee:c.propertyFee,cleaning_fee:c.cleaningFee,refundable_amount:c.refundableAmount,transaction_fee:c.transactionFee,tax:c.tax,total:c.total,guest:{first_name:c.guest.firstName,last_name:c.guest.lastName,email:c.guest.email,phone_number:c.guest.phoneNumber},billing:{country:c.billing.country,state:c.billing.state,city:c.billing.city,street:c.billing.street,zip_code:c.billing.zipCode}},e.prev=1,e.next=4,fetch("".concat(j.BACKEND_URL,"/api/accommodation/booking/add_payment"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});case 4:return r=e.sent,e.next=7,r.json();case 7:o=e.sent,400===r.status&&Object(x.a)("warning","Bad request"),r.ok&&(N.a.event({category:"ecommerce",action:"purchase"}),n.e(31).then(n.t.bind(null,"tseg",7)).then((function(e){return e.default})).then((function(e){console.log("initReactPixel",j.PIXEL_ID),e.init(j.PIXEL_ID),e.track("Purchase",{value:t.total,currency:"USD"})})),u({type:"UPDATE_BOOKING_INFORMATION",payload:B(B({},c),{},{bookingId:o.booking_id})}),l.push("/checkout-confirm")),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(1),Object(x.a)("warning","Server error while handling booking information");case 15:case"end":return e.stop()}}),e,null,[[1,12]])})));return function(){return e.apply(this,arguments)}}();return I(T,null,I(v.a,{as:"section",className:"main-background-2"}),I(v.a,{as:"section",className:"checkout-payment-block"},I(g.a,null,I(s.a,{gutter:32},I(p.a,{lg:14,sm:24},I("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:30}},I("h3",null,"Payment Information"),I("span",null,"Step 3 of 3")),o?I(P.a,null):I(S.PayPalButton,{amount:c.total,style:{color:"blue"},shippingPreference:"NO_SHIPPING",onButtonReady:function(){a(!1)},onSuccess:function(e,t){console.log("__TransactionCompletedBy__",e,t,e.payer.name.given_name),function(e,t){console.log("handlePaymentSuccess",e,t),d()}(e,t)},catchError:function(e){!function(e){console.log("handlePaymentError",e),Object(x.a)("warning","Sorry, we couldn't process your payment")}(e)},options:{clientId:"AQod8JtRRk59F5HjcGOH7ZNymA7N6s2B1WhXH_g_UCBY40Y1LPSt0fxhdaR2rYmIQPNP2k7uZ5gL95Oe",currency:"USD"}}),I("p",null,I(b.a,{href:"/contact",target:"_blank"},I("span",{className:"underlined-link"},"Contact us")),"if you want more information about long-term (+30 days) reservations.")),I(p.a,{lg:10,sm:24},I(_.a,{disabled:!0}))))))},A=o.a.createElement,F=!0;function L(e){var t=e.posts;return A(o.a.Fragment,null,A(i.a,null,A("title",null,"Checkout Payment")),A(c.a,null,A(Y,{posts:t})))}},k0Xt:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PayPalButton=void 0;var r=i(n("q1tI")),o=i(n("i8i4")),a=i(n("17x9"));function i(e){return e&&e.__esModule?e:{default:e}}function c(e){return(c="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function u(){return(u=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function s(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function l(e,t){return!t||"object"!==c(t)&&"function"!==typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function p(e){return(p=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function d(e,t){return(d=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function f(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var y=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=l(this,p(t).call(this,e))).state={isSdkReady:!1},n}var n,a,i;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&d(e,t)}(t,e),n=t,(a=[{key:"componentDidMount",value:function(){"undefined"!==typeof window&&void 0!==window&&void 0===window.paypal?this.addPaypalSdk():"undefined"!==typeof window&&void 0!==window&&void 0!==window.paypal&&this.props.onButtonReady&&this.props.onButtonReady()}},{key:"createOrder",value:function(e,t){var n=this.props,r=n.currency,o=n.options,a=n.amount,i=n.shippingPreference;return t.order.create({purchase_units:[{amount:{currency_code:r||(o&&o.currency?o.currency:"USD"),value:a.toString()}}],application_context:{shipping_preference:i}})}},{key:"onApprove",value:function(e,t){var n=this;return t.order.capture().then((function(t){if(n.props.onSuccess)return n.props.onSuccess(t,e)})).catch((function(e){if(n.props.catchError)return n.props.catchError(e)}))}},{key:"render",value:function(){var e=this,t=this.props,n=t.amount,a=t.onSuccess,i=t.createOrder,c=t.createSubscription,s=t.onApprove,l=t.style;if(!this.state.isSdkReady&&("undefined"===typeof window||void 0===window.paypal))return null;var p=window.paypal.Buttons.driver("react",{React:r.default,ReactDOM:o.default}),d=n&&!i?function(t,n){return e.createOrder(t,n)}:function(e,t){return i(e,t)};return r.default.createElement(p,u({},this.props,{createOrder:c?void 0:d,createSubscription:c,onApprove:a?function(t,n){return e.onApprove(t,n)}:function(e,t){return s(e,t)},style:l}))}},{key:"addPaypalSdk",value:function(){var e=this,t=this.props,n=t.options,r=t.onButtonReady,o=[];Object.keys(n).forEach((function(e){var t=e.split(/(?=[A-Z])/).join("-").toLowerCase();o.push("".concat(t,"=").concat(n[e]))}));var a=document.createElement("script");a.type="text/javascript",a.src="https://www.paypal.com/sdk/js?".concat(o.join("&")),a.async=!0,a.onload=function(){e.setState({isSdkReady:!0}),r&&r()},a.onerror=function(){throw new Error("Paypal SDK could not be loaded.")},document.body.appendChild(a)}}])&&s(n.prototype,a),i&&s(n,i),t}(r.default.Component);t.PayPalButton=y,f(y,"propTypes",{amount:a.default.oneOfType([a.default.number,a.default.string]),currency:a.default.oneOfType([a.default.number,a.default.string]),shippingPreference:a.default.string,onSuccess:a.default.func,catchError:a.default.func,onError:a.default.func,createOrder:a.default.func,createSubscription:a.default.func,onApprove:a.default.func,style:a.default.object,options:a.default.shape({clientId:a.default.string,merchantId:a.default.string,currency:a.default.oneOfType([a.default.number,a.default.string]),intent:a.default.string,commit:a.default.oneOfType([a.default.bool,a.default.string]),vault:a.default.oneOfType([a.default.bool,a.default.string]),component:a.default.string,disableFunding:a.default.string,disableCard:a.default.string,integrationDate:a.default.string,locale:a.default.string,buyerCountry:a.default.string,debug:a.default.oneOfType([a.default.bool,a.default.string])}),onButtonReady:a.default.func}),f(y,"defaultProps",{style:{},options:{clientId:"sb",currency:"USD"},shippingPreference:"GET_FROM_FILE"})}},[["FHed",1,2,6,8,19,0,3,4,7,5,9,10,12,13,14,18,20,25,29,33]]]);