_N_E=(window.webpackJsonp_N_E=window.webpackJsonp_N_E||[]).push([[66],{FHed:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/checkout-payment",function(){return n("GhS2")}])},GhS2:function(e,t,n){"use strict";n.r(t),n.d(t,"__N_SSG",(function(){return F})),n.d(t,"default",(function(){return M}));var r=n("q1tI"),o=n.n(r),a=n("8Kt/"),c=n.n(a),u=n("mq74"),i=n("9xET"),l=n.n(i),s=n("ZPTe"),p=n.n(s),f=n("o0o1"),d=n.n(f),y=n("rePB"),b=n("HaE+"),h=n("YFqc"),m=n.n(h),g=n("iDsv"),v=n("Wasw"),O=n("vOnD"),w=n("YEJx"),_=n("gNcs"),P=n("t9tb"),k=n("EDUr"),j=n("k0Xt"),S=n("OKMn"),E=n("Ye+W"),D=n("wd/R"),N=n.n(D),I=n("nOHt"),R=n("0b+E"),x=o.a.createElement;function T(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function C(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?T(Object(n),!0).forEach((function(t){Object(y.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):T(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var B=O.d.div.withConfig({displayName:"CheckoutPayment__CheckoutPaymentWrapper",componentId:"rqryvw-0"})([".checkout-payment-block{padding:50px 0 100px;h3{color:",";}span{font-size:16px;}}"],Object(w.a)("primary",0));var Y=function(e){var t=Object(r.useState)(!0),o=t[0],a=t[1],c=Object(r.useContext)(P.a),u=c.state,i=c.dispatch,s=Object(I.useRouter)(),f=function(){var e=Object(b.a)(d.a.mark((function e(){var t,r,o;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={bookerville_id:u.bookervilleId,checkin_date:N()(u.checkinDate).format("YYYY-MM-DD"),checkout_date:N()(u.checkoutDate).format("YYYY-MM-DD"),adults:u.adults,children:""===u.children?0:u.children,property_fee:u.propertyFee,cleaning_fee:u.cleaningFee,refundable_amount:u.refundableAmount,transaction_fee:u.transactionFee,tax:u.tax,total:u.total,guest:{first_name:u.guest.firstName,last_name:u.guest.lastName,email:u.guest.email,phone_number:u.guest.phoneNumber},billing:{country:u.billing.country,state:u.billing.state,city:u.billing.city,street:u.billing.street,zip_code:u.billing.zipCode}},e.prev=1,e.next=4,fetch("".concat(E.BACKEND_URL,"/api/accommodation/booking/add_payment"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});case 4:return r=e.sent,e.next=7,r.json();case 7:o=e.sent,400===r.status&&Object(S.a)("warning","Bad request"),r.ok&&(R.a.event({category:"ecommerce",action:"purchase"}),n.e(31).then(n.t.bind(null,"tseg",7)).then((function(e){return e.default})).then((function(e){console.log("initReactPixel",E.PIXEL_ID),e.init(E.PIXEL_ID),e.track("Purchase",{value:t.total,currency:"USD"})})),i({type:"UPDATE_BOOKING_INFORMATION",payload:C(C({},u),{},{bookingId:o.booking_id})}),s.push("/checkout-confirm")),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(1),Object(S.a)("warning","Server error while handling booking information");case 15:case"end":return e.stop()}}),e,null,[[1,12]])})));return function(){return e.apply(this,arguments)}}();return x(B,null,x(v.a,{as:"section",className:"main-background-2"}),x(v.a,{as:"section",className:"checkout-payment-block"},x(g.a,null,x(l.a,{gutter:32},x(p.a,{lg:14,sm:24},x("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:30}},x("h3",null,"Payment Information"),x("span",null,"Step 3 of 3")),o?x(k.a,null):x(j.PayPalButton,{amount:u.total,style:{color:"blue"},shippingPreference:"NO_SHIPPING",onButtonReady:function(){a(!1)},onSuccess:function(e,t){console.log("__TransactionCompletedBy__",e,t,e.payer.name.given_name),function(e,t){console.log("handlePaymentSuccess",e,t),f()}(e,t)},catchError:function(e){!function(e){console.log("handlePaymentError",e),Object(S.a)("warning","Sorry, we couldn't process your payment")}(e)},options:{clientId:"AQod8JtRRk59F5HjcGOH7ZNymA7N6s2B1WhXH_g_UCBY40Y1LPSt0fxhdaR2rYmIQPNP2k7uZ5gL95Oe",currency:"USD"}}),x("p",null,x(m.a,{href:"/contact",target:"_blank"},x("span",{className:"underlined-link"},"Contact us")),"if you want more information about long-term (+30 days) reservations.")),x(p.a,{lg:10,sm:24},x(_.a,{disabled:!0}))))))},A=o.a.createElement,F=!0;function M(e){var t=e.posts;return A(o.a.Fragment,null,A(c.a,null,A("title",null,"Checkout Payment")),A(u.a,null,A(Y,{posts:t})))}},k0Xt:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PayPalButton=void 0;var r=c(n("q1tI")),o=c(n("i8i4")),a=c(n("17x9"));function c(e){return e&&e.__esModule?e:{default:e}}function u(e){return(u="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(){return(i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function l(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function s(e,t){return!t||"object"!==u(t)&&"function"!==typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function p(e){return(p=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function f(e,t){return(f=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function d(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var y=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=s(this,p(t).call(this,e))).state={isSdkReady:!1},n}var n,a,c;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&f(e,t)}(t,e),n=t,(a=[{key:"componentDidMount",value:function(){"undefined"!==typeof window&&void 0!==window&&void 0===window.paypal?this.addPaypalSdk():"undefined"!==typeof window&&void 0!==window&&void 0!==window.paypal&&this.props.onButtonReady&&this.props.onButtonReady()}},{key:"createOrder",value:function(e,t){var n=this.props,r=n.currency,o=n.options,a=n.amount,c=n.shippingPreference;return t.order.create({purchase_units:[{amount:{currency_code:r||(o&&o.currency?o.currency:"USD"),value:a.toString()}}],application_context:{shipping_preference:c}})}},{key:"onApprove",value:function(e,t){var n=this;return t.order.capture().then((function(t){if(n.props.onSuccess)return n.props.onSuccess(t,e)})).catch((function(e){if(n.props.catchError)return n.props.catchError(e)}))}},{key:"render",value:function(){var e=this,t=this.props,n=t.amount,a=t.onSuccess,c=t.createOrder,u=t.createSubscription,l=t.onApprove,s=t.style;if(!this.state.isSdkReady&&("undefined"===typeof window||void 0===window.paypal))return null;var p=window.paypal.Buttons.driver("react",{React:r.default,ReactDOM:o.default}),f=n&&!c?function(t,n){return e.createOrder(t,n)}:function(e,t){return c(e,t)};return r.default.createElement(p,i({},this.props,{createOrder:u?void 0:f,createSubscription:u,onApprove:a?function(t,n){return e.onApprove(t,n)}:function(e,t){return l(e,t)},style:s}))}},{key:"addPaypalSdk",value:function(){var e=this,t=this.props,n=t.options,r=t.onButtonReady,o=[];Object.keys(n).forEach((function(e){var t=e.split(/(?=[A-Z])/).join("-").toLowerCase();o.push("".concat(t,"=").concat(n[e]))}));var a=document.createElement("script");a.type="text/javascript",a.src="https://www.paypal.com/sdk/js?".concat(o.join("&")),a.async=!0,a.onload=function(){e.setState({isSdkReady:!0}),r&&r()},a.onerror=function(){throw new Error("Paypal SDK could not be loaded.")},document.body.appendChild(a)}}])&&l(n.prototype,a),c&&l(n,c),t}(r.default.Component);t.PayPalButton=y,d(y,"propTypes",{amount:a.default.oneOfType([a.default.number,a.default.string]),currency:a.default.oneOfType([a.default.number,a.default.string]),shippingPreference:a.default.string,onSuccess:a.default.func,catchError:a.default.func,onError:a.default.func,createOrder:a.default.func,createSubscription:a.default.func,onApprove:a.default.func,style:a.default.object,options:a.default.shape({clientId:a.default.string,merchantId:a.default.string,currency:a.default.oneOfType([a.default.number,a.default.string]),intent:a.default.string,commit:a.default.oneOfType([a.default.bool,a.default.string]),vault:a.default.oneOfType([a.default.bool,a.default.string]),component:a.default.string,disableFunding:a.default.string,disableCard:a.default.string,integrationDate:a.default.string,locale:a.default.string,buyerCountry:a.default.string,debug:a.default.oneOfType([a.default.bool,a.default.string])}),onButtonReady:a.default.func}),d(y,"defaultProps",{style:{},options:{clientId:"sb",currency:"USD"},shippingPreference:"GET_FROM_FILE"})}},[["FHed",1,2,6,8,19,0,3,4,7,5,9,10,12,13,14,18,20,25,29,33]]]);