{"ast":null,"code":"import _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nimport _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/esm/asyncToGenerator\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport { BACKEND_URL } from \"../env-config\";\nimport { getCookie } from \"@redux/authentication/auth.utils\";\nvar userApi = {\n  getAll: function () {\n    var _getAll = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _context.next = 2;\n              return fetch(\"\".concat(BACKEND_URL, \"/api/users/\"), {\n                method: \"GET\",\n                headers: {\n                  Accept: \"application/json\",\n                  \"Content-Type\": \"application/json\",\n                  Authorization: \"Bearer \".concat(getCookie(\"token\"))\n                }\n              }).then(function (res) {\n                if (res.ok) {\n                  return res.json();\n                }\n\n                throw res;\n              })[\"catch\"](handleError);\n\n            case 2:\n              return _context.abrupt(\"return\", _context.sent);\n\n            case 3:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    }));\n\n    function getAll() {\n      return _getAll.apply(this, arguments);\n    }\n\n    return getAll;\n  }(),\n  getOne: function () {\n    var _getOne = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2(id) {\n      return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              _context2.next = 2;\n              return fetch(\"\".concat(BACKEND_URL, \"/api/users/\").concat(id, \"/\"), {\n                method: \"GET\",\n                headers: {\n                  Accept: \"application/json\",\n                  \"Content-Type\": \"application/json\",\n                  Authorization: \"Bearer \".concat(getCookie(\"token\"))\n                }\n              }).then(function (res) {\n                if (res.ok) {\n                  return res.json();\n                }\n\n                throw res;\n              })[\"catch\"](handleError);\n\n            case 2:\n              return _context2.abrupt(\"return\", _context2.sent);\n\n            case 3:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, _callee2);\n    }));\n\n    function getOne(_x) {\n      return _getOne.apply(this, arguments);\n    }\n\n    return getOne;\n  }(),\n  add: function () {\n    var _add = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee3(user) {\n      return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n        while (1) {\n          switch (_context3.prev = _context3.next) {\n            case 0:\n              _context3.next = 2;\n              return fetch(\"\".concat(BACKEND_URL, \"/api/users/\"), {\n                method: \"POST\",\n                headers: {\n                  Accept: \"application/json\",\n                  \"Content-Type\": \"application/json\",\n                  Authorization: \"Bearer \".concat(getCookie(\"token\"))\n                },\n                body: JSON.stringify(user)\n              }).then(function (res) {\n                if (res.ok) {\n                  return res.json();\n                }\n\n                throw res;\n              })[\"catch\"](handleError);\n\n            case 2:\n              return _context3.abrupt(\"return\", _context3.sent);\n\n            case 3:\n            case \"end\":\n              return _context3.stop();\n          }\n        }\n      }, _callee3);\n    }));\n\n    function add(_x2) {\n      return _add.apply(this, arguments);\n    }\n\n    return add;\n  }(),\n  update: function () {\n    var _update = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee4(user) {\n      return _regeneratorRuntime.wrap(function _callee4$(_context4) {\n        while (1) {\n          switch (_context4.prev = _context4.next) {\n            case 0:\n              _context4.next = 2;\n              return fetch(\"\".concat(BACKEND_URL, \"/api/users/\").concat(user.id, \"/\"), {\n                method: \"PATCH\",\n                headers: {\n                  Accept: \"application/json\",\n                  \"Content-Type\": \"application/json\",\n                  Authorization: \"Bearer \".concat(getCookie(\"token\"))\n                },\n                body: JSON.stringify(user)\n              }).then(function (res) {\n                if (res.ok) {\n                  return res.json();\n                }\n\n                throw res;\n              })[\"catch\"](handleError);\n\n            case 2:\n              return _context4.abrupt(\"return\", _context4.sent);\n\n            case 3:\n            case \"end\":\n              return _context4.stop();\n          }\n        }\n      }, _callee4);\n    }));\n\n    function update(_x3) {\n      return _update.apply(this, arguments);\n    }\n\n    return update;\n  }(),\n  \"delete\": function () {\n    var _delete2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee5(userId) {\n      return _regeneratorRuntime.wrap(function _callee5$(_context5) {\n        while (1) {\n          switch (_context5.prev = _context5.next) {\n            case 0:\n              _context5.next = 2;\n              return fetch(\"\".concat(BACKEND_URL, \"/api/users/\").concat(userId, \"/\"), {\n                method: \"DELETE\",\n                headers: {\n                  Accept: \"application/json\",\n                  \"Content-Type\": \"application/json\",\n                  Authorization: \"Bearer \".concat(getCookie(\"token\"))\n                }\n              }).then(function (res) {\n                if (res.ok) {\n                  return null;\n                }\n\n                throw res;\n              })[\"catch\"](handleError);\n\n            case 2:\n              return _context5.abrupt(\"return\", _context5.sent);\n\n            case 3:\n            case \"end\":\n              return _context5.stop();\n          }\n        }\n      }, _callee5);\n    }));\n\n    function _delete(_x4) {\n      return _delete2.apply(this, arguments);\n    }\n\n    return _delete;\n  }()\n};\n\nvar handleError = function handleError(res) {\n  console.log(\"___handleError___\", res);\n\n  if (res instanceof Error) {\n    throw Error('Network error');\n  }\n\n  var error = new Error(); // res.json().then((responseJson) => {\n  //     error = {\n  //         status: res.status,\n  //         statusText: res.statusText,\n  //         message: responseJson.detail || 'Application Error'\n  //     }\n  //     throw error\n  // })\n\n  if (res.status >= 400 && res.status < 500) {\n    console.log(res.text());\n    error = {\n      status: res.status,\n      statusText: res.statusText,\n      message: res.detail || 'Application Error'\n    };\n    throw error;\n  }\n\n  if (res.status >= 500) {\n    error = {\n      status: res.status,\n      statusText: res.statusText,\n      message: res.detail || 'Server Error'\n    };\n    throw error;\n  }\n\n  error = _objectSpread(_objectSpread({}, error), {}, {\n    status: res.status,\n    statusText: res.statusText,\n    message: res.detail || 'Error'\n  });\n  throw error;\n};\n\nexport default userApi;","map":{"version":3,"sources":["E:/Projects/starsofboston/next-django/isomorphic-next/service/userApi.js"],"names":["BACKEND_URL","getCookie","userApi","getAll","fetch","method","headers","Accept","Authorization","then","res","ok","json","handleError","getOne","id","add","user","body","JSON","stringify","update","userId","console","log","Error","error","status","text","statusText","message","detail"],"mappings":";;;;;;;;AAAA,SAAQA,WAAR,QAA0B,eAA1B;AACA,SAAQC,SAAR,QAAwB,kCAAxB;AAEA,IAAMC,OAAO,GAAG;AACZC,EAAAA,MAAM;AAAA,2EAAE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,qBACEC,KAAK,WAAIJ,WAAJ,kBAA8B;AACrCK,gBAAAA,MAAM,EAAE,KAD6B;AAErCC,gBAAAA,OAAO,EAAE;AACLC,kBAAAA,MAAM,EAAE,kBADH;AAEL,kCAAgB,kBAFX;AAGLC,kBAAAA,aAAa,mBAAYP,SAAS,CAAC,OAAD,CAArB;AAHR;AAF4B,eAA9B,CAAL,CAQDQ,IARC,CAQI,UAAAC,GAAG,EAAI;AACT,oBAAIA,GAAG,CAACC,EAAR,EAAY;AACR,yBAAOD,GAAG,CAACE,IAAJ,EAAP;AACH;;AACD,sBAAMF,GAAN;AACH,eAbC,WAcKG,WAdL,CADF;;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAAF;;AAAA;AAAA;AAAA;;AAAA;AAAA,KADM;AAkBZC,EAAAA,MAAM;AAAA,2EAAE,kBAAOC,EAAP;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,qBAAoBX,KAAK,WAAIJ,WAAJ,wBAA6Be,EAA7B,QAAoC;AACjEV,gBAAAA,MAAM,EAAE,KADyD;AAEjEC,gBAAAA,OAAO,EAAE;AACLC,kBAAAA,MAAM,EAAE,kBADH;AAEL,kCAAgB,kBAFX;AAGLC,kBAAAA,aAAa,mBAAYP,SAAS,CAAC,OAAD,CAArB;AAHR;AAFwD,eAApC,CAAL,CAQvBQ,IARuB,CAQlB,UAAAC,GAAG,EAAI;AACT,oBAAIA,GAAG,CAACC,EAAR,EAAY;AACR,yBAAOD,GAAG,CAACE,IAAJ,EAAP;AACH;;AACD,sBAAMF,GAAN;AACH,eAbuB,WAcjBG,WAdiB,CAApB;;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAAF;;AAAA;AAAA;AAAA;;AAAA;AAAA,KAlBM;AAkCZG,EAAAA,GAAG;AAAA,wEAAE,kBAAOC,IAAP;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,qBACKb,KAAK,WAAIJ,WAAJ,kBAA8B;AACrCK,gBAAAA,MAAM,EAAE,MAD6B;AAErCC,gBAAAA,OAAO,EAAE;AACLC,kBAAAA,MAAM,EAAE,kBADH;AAEL,kCAAgB,kBAFX;AAGLC,kBAAAA,aAAa,mBAAYP,SAAS,CAAC,OAAD,CAArB;AAHR,iBAF4B;AAOrCiB,gBAAAA,IAAI,EAAEC,IAAI,CAACC,SAAL,CAAeH,IAAf;AAP+B,eAA9B,CAAL,CASDR,IATC,CASI,UAAAC,GAAG,EAAI;AACT,oBAAIA,GAAG,CAACC,EAAR,EAAY;AACR,yBAAOD,GAAG,CAACE,IAAJ,EAAP;AACH;;AACD,sBAAMF,GAAN;AACH,eAdC,WAeKG,WAfL,CADL;;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAAF;;AAAA;AAAA;AAAA;;AAAA;AAAA,KAlCS;AAoDZQ,EAAAA,MAAM;AAAA,2EAAE,kBAAOJ,IAAP;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,qBACEb,KAAK,WAAIJ,WAAJ,wBAA6BiB,IAAI,CAACF,EAAlC,QAAyC;AAChDV,gBAAAA,MAAM,EAAE,OADwC;AAEhDC,gBAAAA,OAAO,EAAE;AACLC,kBAAAA,MAAM,EAAE,kBADH;AAEL,kCAAgB,kBAFX;AAGLC,kBAAAA,aAAa,mBAAYP,SAAS,CAAC,OAAD,CAArB;AAHR,iBAFuC;AAOhDiB,gBAAAA,IAAI,EAAEC,IAAI,CAACC,SAAL,CAAeH,IAAf;AAP0C,eAAzC,CAAL,CASDR,IATC,CASI,UAAAC,GAAG,EAAI;AACT,oBAAIA,GAAG,CAACC,EAAR,EAAY;AACR,yBAAOD,GAAG,CAACE,IAAJ,EAAP;AACH;;AACD,sBAAMF,GAAN;AACH,eAdC,WAeKG,WAfL,CADF;;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAAF;;AAAA;AAAA;AAAA;;AAAA;AAAA,KApDM;AAsEZ;AAAA,4EAAQ,kBAAOS,MAAP;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,qBACElB,KAAK,WAAIJ,WAAJ,wBAA6BsB,MAA7B,QAAwC;AAC/CjB,gBAAAA,MAAM,EAAE,QADuC;AAE/CC,gBAAAA,OAAO,EAAE;AACLC,kBAAAA,MAAM,EAAE,kBADH;AAEL,kCAAgB,kBAFX;AAGLC,kBAAAA,aAAa,mBAAYP,SAAS,CAAC,OAAD,CAArB;AAHR;AAFsC,eAAxC,CAAL,CAQDQ,IARC,CAQI,UAAAC,GAAG,EAAI;AACT,oBAAIA,GAAG,CAACC,EAAR,EAAY;AACR,yBAAO,IAAP;AACH;;AACD,sBAAMD,GAAN;AACH,eAbC,WAcKG,WAdL,CADF;;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAAR;;AAAA;AAAA;AAAA;;AAAA;AAAA;AAtEY,CAAhB;;AAwFA,IAAMA,WAAW,GAAG,SAAdA,WAAc,CAACH,GAAD,EAAS;AACzBa,EAAAA,OAAO,CAACC,GAAR,CAAY,mBAAZ,EAAiCd,GAAjC;;AACA,MAAIA,GAAG,YAAYe,KAAnB,EAA0B;AACtB,UAAMA,KAAK,CAAC,eAAD,CAAX;AACH;;AAED,MAAIC,KAAK,GAAG,IAAID,KAAJ,EAAZ,CANyB,CAOzB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AACA,MAAIf,GAAG,CAACiB,MAAJ,IAAc,GAAd,IAAqBjB,GAAG,CAACiB,MAAJ,GAAa,GAAtC,EAA2C;AACvCJ,IAAAA,OAAO,CAACC,GAAR,CAAYd,GAAG,CAACkB,IAAJ,EAAZ;AACAF,IAAAA,KAAK,GAAG;AACJC,MAAAA,MAAM,EAAEjB,GAAG,CAACiB,MADR;AAEJE,MAAAA,UAAU,EAAEnB,GAAG,CAACmB,UAFZ;AAGJC,MAAAA,OAAO,EAAEpB,GAAG,CAACqB,MAAJ,IAAc;AAHnB,KAAR;AAKA,UAAML,KAAN;AACH;;AAED,MAAIhB,GAAG,CAACiB,MAAJ,IAAc,GAAlB,EAAuB;AACnBD,IAAAA,KAAK,GAAG;AACJC,MAAAA,MAAM,EAAEjB,GAAG,CAACiB,MADR;AAEJE,MAAAA,UAAU,EAAEnB,GAAG,CAACmB,UAFZ;AAGJC,MAAAA,OAAO,EAAEpB,GAAG,CAACqB,MAAJ,IAAc;AAHnB,KAAR;AAKA,UAAML,KAAN;AACH;;AAEDA,EAAAA,KAAK,mCACEA,KADF;AAEDC,IAAAA,MAAM,EAAEjB,GAAG,CAACiB,MAFX;AAGDE,IAAAA,UAAU,EAAEnB,GAAG,CAACmB,UAHf;AAIDC,IAAAA,OAAO,EAAEpB,GAAG,CAACqB,MAAJ,IAAc;AAJtB,IAAL;AAMA,QAAML,KAAN;AACH,CAzCD;;AA2CA,eAAexB,OAAf","sourcesContent":["import {BACKEND_URL} from \"../env-config\";\r\nimport {getCookie} from \"@redux/authentication/auth.utils\";\r\n\r\nconst userApi = {\r\n    getAll: async () =>\r\n        await fetch(`${BACKEND_URL}/api/users/`, {\r\n            method: \"GET\",\r\n            headers: {\r\n                Accept: \"application/json\",\r\n                \"Content-Type\": \"application/json\",\r\n                Authorization: `Bearer ${getCookie(\"token\")}`,\r\n            },\r\n        })\r\n            .then(res => {\r\n                if (res.ok) {\r\n                    return res.json()\r\n                }\r\n                throw res;\r\n            })\r\n            .catch(handleError),\r\n\r\n    getOne: async (id) => await fetch(`${BACKEND_URL}/api/users/${id}/`, {\r\n        method: \"GET\",\r\n        headers: {\r\n            Accept: \"application/json\",\r\n            \"Content-Type\": \"application/json\",\r\n            Authorization: `Bearer ${getCookie(\"token\")}`,\r\n        },\r\n    })\r\n        .then(res => {\r\n            if (res.ok) {\r\n                return res.json()\r\n            }\r\n            throw res;\r\n        })\r\n        .catch(handleError),\r\n\r\n    add: async (user) =>\r\n        await fetch(`${BACKEND_URL}/api/users/`, {\r\n            method: \"POST\",\r\n            headers: {\r\n                Accept: \"application/json\",\r\n                \"Content-Type\": \"application/json\",\r\n                Authorization: `Bearer ${getCookie(\"token\")}`,\r\n            },\r\n            body: JSON.stringify(user),\r\n        })\r\n            .then(res => {\r\n                if (res.ok) {\r\n                    return res.json()\r\n                }\r\n                throw res;\r\n            })\r\n            .catch(handleError),\r\n\r\n    update: async (user) =>\r\n        await fetch(`${BACKEND_URL}/api/users/${user.id}/`, {\r\n            method: \"PATCH\",\r\n            headers: {\r\n                Accept: \"application/json\",\r\n                \"Content-Type\": \"application/json\",\r\n                Authorization: `Bearer ${getCookie(\"token\")}`,\r\n            },\r\n            body: JSON.stringify(user),\r\n        })\r\n            .then(res => {\r\n                if (res.ok) {\r\n                    return res.json()\r\n                }\r\n                throw res;\r\n            })\r\n            .catch(handleError),\r\n\r\n    delete: async (userId) =>\r\n        await fetch(`${BACKEND_URL}/api/users/${userId}/`, {\r\n            method: \"DELETE\",\r\n            headers: {\r\n                Accept: \"application/json\",\r\n                \"Content-Type\": \"application/json\",\r\n                Authorization: `Bearer ${getCookie(\"token\")}`,\r\n            },\r\n        })\r\n            .then(res => {\r\n                if (res.ok) {\r\n                    return null\r\n                }\r\n                throw res;\r\n            })\r\n            .catch(handleError),\r\n};\r\n\r\nconst handleError = (res) => {\r\n    console.log(\"___handleError___\", res)\r\n    if (res instanceof Error) {\r\n        throw Error('Network error');\r\n    }\r\n\r\n    let error = new Error();\r\n    // res.json().then((responseJson) => {\r\n    //     error = {\r\n    //         status: res.status,\r\n    //         statusText: res.statusText,\r\n    //         message: responseJson.detail || 'Application Error'\r\n    //     }\r\n    //     throw error\r\n    // })\r\n    if (res.status >= 400 && res.status < 500) {\r\n        console.log(res.text())\r\n        error = {\r\n            status: res.status,\r\n            statusText: res.statusText,\r\n            message: res.detail || 'Application Error'\r\n        }\r\n        throw error\r\n    }\r\n\r\n    if (res.status >= 500) {\r\n        error = {\r\n            status: res.status,\r\n            statusText: res.statusText,\r\n            message: res.detail || 'Server Error'\r\n        }\r\n        throw error\r\n    }\r\n\r\n    error = {\r\n        ...error,\r\n        status: res.status,\r\n        statusText: res.statusText,\r\n        message: res.detail || 'Error'\r\n    }\r\n    throw error\r\n}\r\n\r\nexport default userApi"]},"metadata":{},"sourceType":"module"}