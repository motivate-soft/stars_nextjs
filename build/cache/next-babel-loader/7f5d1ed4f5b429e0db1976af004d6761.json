{"ast":null,"code":"import _Row from \"antd/lib/row\";\nimport _Col from \"antd/lib/col\";\nimport _Button from \"antd/lib/button\";\nvar __jsx = React.createElement;\n\nfunction _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nimport React from \"react\";\nimport LayoutWrapper from \"@iso/components/utility/layoutWrapper\";\nimport Tabs, { TabPane } from \"@iso/components/uielements/tabs\";\nimport Editor from \"@iso/components/uielements/editor\";\nimport Location from \"@components/Admin/Property/Location/Location\";\nimport basicStyle from \"@iso/assets/styles/constants\";\nimport arrayMove from \"array-move\";\nimport Setting from \"@components/Admin/Property/Setting/Setting\";\nimport Main from \"@components/Admin/Property/Main/Main\";\nimport Amenity from \"@components/Admin/Property/Amenity/Amenity\";\nimport Rooms from \"@components/Admin/Property/Room/Rooms\";\nimport Gallery from \"@components/Admin/Property/Gallery/Gallery\";\nimport FeaturedImage from \"@components/Admin/Property/FeaturedImage/FeaturedImage\";\nimport { useDispatch } from \"react-redux\";\nimport propertyActions from \"@redux/properties/actions\";\nimport { SinglePropertyWrapper } from \"@components/Admin/Property/PropertyList.styles\";\nimport Link from \"next/link\";\nconst newProperty = {\n  name: \"\",\n  category: \"\",\n  bookervilleId: \"\",\n  description: \"\",\n  neighbourhood: \"\",\n  transit: \"\",\n  address: \"\",\n  lat: \"\",\n  lng: \"\",\n  rooms: [],\n  amenities: [],\n  galleryImgs: [],\n  featuredImg: null,\n  similarProperties: [],\n  price: \"\",\n  minPrice: \"\",\n  minMonthPrice: \"\",\n  bathroomCount: \"\",\n  bedroomCount: \"\",\n  sleeps: \"\",\n  minSleeps: 2,\n  cleaningFee: \"\",\n  transactionFeeRate: \"\",\n  taxRate: \"\",\n  tour360: \"\",\n  refundableAmount: \"\",\n  furnished: true,\n  rentalParking: true,\n  petsConsidered: true\n};\nexport default function AddProperty() {\n  const [state, setState] = React.useState(newProperty);\n  const dispatch = useDispatch();\n  React.useEffect(() => {\n    console.log(\"state\", state);\n  }, [state]);\n\n  function callback(key) {\n    console.log(key);\n  }\n\n  function handleSave() {\n    var _state$featuredImg;\n\n    const property = {\n      bookerville_id: state.bookervilleId,\n      name: state.name,\n      category: state.category,\n      address: state.address,\n      lat: state.lat,\n      lng: state.lng,\n      description: state.description,\n      neighbourhood: state.neighbourhood,\n      transit: state.transit,\n      price: state.price,\n      min_price: state.minPrice,\n      min_month_price: state.minMonthPrice,\n      bedroom_count: state.bedroomCount,\n      bathroom_count: state.bathroomCount,\n      similar_properties: state.similarProperties,\n      sleeps: state.sleeps,\n      min_sleeps: state.minSleeps,\n      cleaning_fee: state.cleaningFee,\n      transactionfee_rate: state.transactionFeeRate,\n      tax_rate: state.taxRate,\n      refundable_amount: state.refundableAmount,\n      tour360: state.tour360,\n      furnished: state.furnished,\n      rental_parking: state.rentalParking,\n      pets_considered: state.petsConsidered,\n      property_rooms: state.rooms.map(room => ({\n        name: room.name,\n        bed_type: room.bedType\n      })),\n      amenities: state.amenities,\n      featured_img: (_state$featuredImg = state.featuredImg) === null || _state$featuredImg === void 0 ? void 0 : _state$featuredImg.id,\n      gallery_imgs: state.galleryImgs.map(image => image.id)\n    };\n    dispatch(propertyActions.addProperty(property));\n  }\n\n  function handleReset() {\n    setState({\n      newProperty\n    });\n  }\n\n  const editorOption = {\n    style: {\n      width: \"90%\",\n      height: \"70%\"\n    },\n    toolbarClassName: \"home-toolbar\",\n    wrapperClassName: \"home-wrapper\",\n    editorClassName: \"home-editor\" // onEditorStateChange: onEditorStateChange,\n    // uploadCallback: uploadCallback,\n    // toolbar: {image: {uploadCallback: uploadCallback}},\n\n  };\n\n  function handlePlaceChange(place) {\n    setState(_objectSpread(_objectSpread({}, state), {}, {\n      address: place.formatted_address,\n      lat: place.geometry.location.lat(),\n      lng: place.geometry.location.lng()\n    }));\n  }\n\n  function handlePlaceReset() {\n    setState(_objectSpread(_objectSpread({}, state), {}, {\n      address: \"\",\n      lat: \"\",\n      lng: \"\"\n    }));\n  }\n\n  function handleSettingChange(changedValues, allValues) {\n    console.log(\"handleSettingChange\", changedValues, allValues);\n    setState(_objectSpread(_objectSpread({}, state), allValues));\n  }\n\n  function handleMainInfoChange(changedValues, allValues) {\n    console.log(\"handleMainInfoChange\", changedValues, allValues);\n    setState(_objectSpread(_objectSpread({}, state), allValues));\n  } // function handleAmenityChange(changedValues, allValues) {\n  //     console.log(\"handleAmenityChange\", changedValues, allValues);\n  //     const array = [];\n  //     Object.keys(allValues).map((key) => {\n  //         if (allValues[key]) {\n  //             array.push(key);\n  //         }\n  //     });\n  //     setState({\n  //         ...state,\n  //         amenities: array,\n  //     });\n  // }\n\n\n  function handleToggleAmenityOption(amenityId) {\n    console.log(\"amenityId\", state.amenities, amenityId);\n    let array = state.amenities;\n    let index = array.indexOf(amenityId);\n\n    if (index > -1) {\n      array.splice(index, 1);\n      setState(_objectSpread(_objectSpread({}, state), {}, {\n        amenities: array\n      }));\n    } else {\n      array.push(amenityId);\n      setState(_objectSpread(_objectSpread({}, state), {}, {\n        amenities: array\n      }));\n    }\n\n    console.log(\"handleToggleAmenityOption\", array, state);\n  }\n\n  function handleChangeRoom(values, id) {\n    const newRooms = state.rooms.map((room, index) => {\n      if (room.id === id) {\n        return _objectSpread(_objectSpread({}, room), values);\n      }\n\n      return room;\n    });\n    console.log(\"handleChangeRoom\", newRooms);\n    setState(_objectSpread(_objectSpread({}, state), {}, {\n      rooms: newRooms\n    }));\n  }\n\n  function handleAddRoom() {\n    const generatedId = new Date().getTime();\n    console.log(\"array\", array, generatedId);\n    let array = state.rooms;\n    array.push({\n      id: generatedId,\n      name: \"\",\n      bedType: \"Q\"\n    });\n    console.log(\"handleAddRoom\", array);\n    setState(_objectSpread(_objectSpread({}, state), {}, {\n      rooms: array\n    }));\n  }\n\n  function handleRemoveRoom(roomId) {\n    console.log(\"handleRemoveRoom\", roomId);\n    setState(_objectSpread(_objectSpread({}, state), {}, {\n      rooms: state.rooms.filter(room => room.id !== roomId)\n    }));\n  }\n\n  function handleUploadSuccess(image) {\n    const {\n      galleryImgs\n    } = state;\n    galleryImgs.push(_objectSpread(_objectSpread({}, image), {}, {\n      order: galleryImgs.length - 1\n    }));\n    setState(_objectSpread(_objectSpread({}, state), {}, {\n      galleryImgs\n    }));\n  }\n\n  function handleSortEnd({\n    oldIndex,\n    newIndex\n  }) {\n    const newArray = arrayMove(state.galleryImgs, oldIndex, newIndex);\n    setState(_objectSpread(_objectSpread({}, state), {}, {\n      galleryImgs: newArray.map((image, index) => _objectSpread(_objectSpread({}, image), {}, {\n        order: index + 1\n      }))\n    }));\n  }\n\n  function handleSelectFeatured(image) {\n    setState(_objectSpread(_objectSpread({}, state), {}, {\n      featuredImg: image\n    }));\n  }\n\n  const {\n    rowStyle,\n    colStyle\n  } = basicStyle;\n  return __jsx(LayoutWrapper, null, __jsx(SinglePropertyWrapper, null, __jsx(\"div\", {\n    className: \"property-detail-actions\"\n  }, __jsx(_Button, {\n    type: \"primary\",\n    onClick: handleSave,\n    style: {\n      marginRight: 20\n    }\n  }, \"Save\"), __jsx(_Button, {\n    type: \"default\",\n    onClick: handleReset\n  }, \"Reset\"), __jsx(Link, {\n    href: \"/admin/property\"\n  }, __jsx(_Button, {\n    type: \"primary\"\n  }, \"Back to List\"))), __jsx(_Row, {\n    style: rowStyle,\n    gutter: 0,\n    justify: \"start\"\n  }, __jsx(_Col, {\n    lg: 8,\n    md: 12,\n    sm: 24,\n    xs: 24,\n    style: colStyle\n  }, __jsx(\"div\", {\n    className: \"property-detail-main\"\n  }, __jsx(Main, {\n    name: state.name,\n    bookervilleId: state.bookervilleId,\n    category: state.category,\n    onValuesChange: handleMainInfoChange\n  }), __jsx(Gallery, {\n    items: state.galleryImgs,\n    onSortEnd: handleSortEnd,\n    onUploadSuccess: handleUploadSuccess\n  }), __jsx(FeaturedImage, {\n    items: state.galleryImgs,\n    selectedItem: state.featuredImg,\n    onUploadSuccess: handleUploadSuccess,\n    onSelectImage: handleSelectFeatured\n  }))), __jsx(_Col, {\n    lg: 16,\n    md: 12,\n    sm: 24,\n    xs: 24,\n    style: colStyle\n  }, __jsx(Tabs, {\n    defaultActiveKey: \"1\",\n    onChange: callback,\n    className: \"property-detail-tab\"\n  }, [\"description\", \"neighbourhood\", \"transit\"].map(item => __jsx(TabPane, {\n    tab: item.charAt(0).toUpperCase() + item.slice(1),\n    key: item\n  }, __jsx(Editor, _extends({}, editorOption, {\n    onEditorStateChange: html => setState(_objectSpread(_objectSpread({}, state), {}, {\n      [item]: html\n    }))\n  })))), __jsx(TabPane, {\n    tab: \"Location\",\n    key: \"location\"\n  }, __jsx(Location, {\n    address: state.address,\n    center: {\n      lat: state.lat,\n      lng: state.lng\n    },\n    onPlaceChange: handlePlaceChange,\n    onReset: handlePlaceReset\n  })), __jsx(TabPane, {\n    tab: \"Setting\",\n    key: \"setting\"\n  }, __jsx(Setting, {\n    setting: state,\n    onValuesChange: handleSettingChange\n  })), __jsx(TabPane, {\n    tab: \"Amenity\",\n    key: \"amenity\"\n  }, __jsx(Amenity, {\n    amenities: [],\n    onValuesChange: handleToggleAmenityOption,\n    onToggleOption: handleToggleAmenityOption\n  })), __jsx(TabPane, {\n    tab: \"Bedtype\",\n    key: \"rooms\"\n  }, __jsx(Rooms, {\n    rooms: state.rooms,\n    onRoomChange: handleChangeRoom,\n    onAddRoom: handleAddRoom,\n    onRemoveRoom: handleRemoveRoom,\n    onValuesChange: handleSettingChange\n  })))))));\n}","map":null,"metadata":{},"sourceType":"module"}