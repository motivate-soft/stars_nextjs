{"ast":null,"code":"import _Row from \"antd/lib/row\";\nimport _Col from \"antd/lib/col\";\nimport _Button from \"antd/lib/button\";\nvar _jsxFileName = \"E:\\\\Projects\\\\starsofboston\\\\next-django\\\\isomorphic-next\\\\components\\\\Admin\\\\Property\\\\EditProperty.js\";\nvar __jsx = React.createElement;\n\nfunction _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nimport React, { useEffect } from \"react\";\nimport LayoutWrapper from \"@iso/components/utility/layoutWrapper\";\nimport Box from \"@iso/components/utility/box\";\nimport Tabs, { TabPane } from \"@iso/components/uielements/tabs\";\nimport Location from \"@components/Admin/Property/Location/Location\";\nimport basicStyle from \"@iso/assets/styles/constants\";\nimport Setting from \"@components/Admin/Property/Setting/Setting\";\nimport Main from \"@components/Admin/Property/Main/Main\";\nimport Amenity from \"@components/Admin/Property/Amenity/Amenity\";\nimport Rooms from \"@components/Admin/Property/Room/Rooms\";\nimport arrayMove from \"array-move\";\nimport Gallery from \"@components/Admin/Property/Gallery/Gallery\";\nimport Editor from \"@components/Admin/Property/Editor/Editor\";\nimport FeaturedImage from \"@components/Admin/Property/FeaturedImage/FeaturedImage\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport propertyActions from \"@redux/properties/actions\";\nimport PricingCalendar from \"@components/Admin/Property/PricingCalendar/PricingCalendar\";\n\nfunction uploadCallback(file) {\n  return new Promise((resolve, reject) => {\n    const xhr = new XMLHttpRequest();\n    xhr.open(\"POST\", \"https://api.imgur.com/3/image\");\n    xhr.setRequestHeader(\"Authorization\", \"Client-ID 8d26ccd12712fca\");\n    const data = new FormData();\n    data.append(\"image\", file);\n    xhr.send(data);\n    xhr.addEventListener(\"load\", () => {\n      const response = JSON.parse(xhr.responseText);\n      resolve(response);\n    });\n    xhr.addEventListener(\"error\", () => {\n      const error = JSON.parse(xhr.responseText);\n      reject(error);\n    });\n  });\n}\n\nconst newProperty = {\n  name: \"\",\n  category: \"\",\n  bookervilleId: \"\",\n  description: \"\",\n  neighbourhood: \"\",\n  transit: \"\",\n  address: \"\",\n  lat: \"\",\n  lng: \"\",\n  rooms: [],\n  amenities: [],\n  galleryImgs: [],\n  featuredImg: null,\n  similarProperties: [],\n  price: \"\",\n  minPrice: \"\",\n  minMonthPrice: \"\",\n  bathroomCount: \"\",\n  bedroomCount: \"\",\n  sleeps: \"\",\n  minSleeps: 2,\n  cleaningFee: \"\",\n  transactionFeeRate: \"\",\n  taxRate: \"\",\n  tour360: \"\",\n  refundableAmount: \"\",\n  furnished: true,\n  rentalParking: true,\n  petsConsidered: true\n};\nexport default function EditProperty(props) {\n  const {\n    propertyId\n  } = props;\n  const [state, setState] = React.useState(newProperty);\n  const dispatch = useDispatch();\n  const {\n    selectedItem\n  } = useSelector(state => state.Properties);\n  useEffect(() => {\n    dispatch(propertyActions.getProperty(propertyId));\n  }, []);\n  useEffect(() => {\n    if (`${selectedItem.id}` === `${propertyId}`) {\n      setState({\n        id: selectedItem.id,\n        bookervilleId: selectedItem.bookerville_id,\n        name: selectedItem.name,\n        category: `${selectedItem.category}`,\n        address: selectedItem.address,\n        lat: selectedItem.lat,\n        lng: selectedItem.lng,\n        description: selectedItem.description,\n        neighbourhood: selectedItem.neighbourhood,\n        transit: selectedItem.transit,\n        price: selectedItem.price,\n        minPrice: selectedItem.min_price,\n        minMonthPrice: selectedItem.min_month_price,\n        bedroomCount: selectedItem.bedroom_count,\n        bathroomCount: selectedItem.bathroom_count,\n        similarProperties: selectedItem.similar_properties,\n        sleeps: selectedItem.sleeps,\n        minSleeps: selectedItem.min_sleeps,\n        cleaningFee: selectedItem.cleaning_fee,\n        transactionFeeRate: selectedItem.transactionfee_rate,\n        taxRate: selectedItem.tax_rate,\n        refundableAmount: selectedItem.refundable_amount,\n        tour360: selectedItem.tour360,\n        furnished: renderOptionValue(selectedItem.furnished),\n        rentalParking: renderOptionValue(selectedItem.rental_parking),\n        petsConsidered: renderOptionValue(selectedItem.pets_considered),\n        rooms: selectedItem.property_rooms.map(room => ({\n          id: room.id,\n          name: room.name,\n          bedType: room.bed_type\n        })),\n        amenities: selectedItem.amenities,\n        featuredImg: selectedItem.featured_img,\n        galleryImgs: selectedItem.gallery_imgs\n      });\n    }\n  }, [selectedItem]);\n  useEffect(() => {\n    console.log(\"state\", state);\n  }, [state]);\n\n  function callback(key) {\n    console.log(key);\n  }\n\n  function handleSave() {\n    const property = {\n      id: selectedItem.id,\n      bookerville_id: state.bookervilleId,\n      name: state.name,\n      category: state.category,\n      address: state.address,\n      lat: state.lat,\n      lng: state.lng,\n      description: state.description,\n      neighbourhood: state.neighbourhood,\n      transit: state.transit,\n      price: state.price,\n      min_price: state.minPrice,\n      min_month_price: state.minMonthPrice,\n      bedroom_count: state.bedroomCount,\n      bathroom_count: state.bathroomCount,\n      similar_properties: state.similarProperties,\n      sleeps: state.sleeps,\n      min_sleeps: state.minSleeps,\n      cleaning_fee: state.cleaningFee,\n      transactionfee_rate: state.transactionFeeRate,\n      tax_rate: state.taxRate,\n      refundable_amount: state.refundableAmount,\n      tour360: state.tour360,\n      furnished: state.furnished,\n      rental_parking: state.rentalParking,\n      pets_considered: state.petsConsidered,\n      property_rooms: makeRoomsArray(),\n      amenities: state.amenities,\n      featured_img: state.featuredImg.id,\n      gallery_imgs: state.galleryImgs.map(image => image.id),\n      images: state.images\n    };\n    dispatch(propertyActions.updateProperty(property));\n  }\n\n  function handleReset() {\n    setState({\n      newProperty\n    });\n  }\n\n  function renderOptionValue(value) {\n    if (value === true) {\n      return \"1\";\n    }\n\n    return \"0\";\n  }\n\n  function makeRoomsArray() {\n    let array = state.rooms.map(room => {\n      return room.id > 10000 ? {\n        name: room.name ? room.name : \"\",\n        bed_type: room.bedType ? room.bedType : \"\"\n      } : {\n        id: room.id,\n        name: room.name ? room.name : \"\",\n        bed_type: room.bedType ? room.bedType : \"\"\n      };\n    });\n    return array;\n  }\n\n  const editorOption = {\n    style: {\n      width: \"90%\",\n      height: \"70%\"\n    },\n    toolbarClassName: \"home-toolbar\",\n    wrapperClassName: \"home-wrapper\",\n    editorClassName: \"home-editor\",\n    uploadCallback: uploadCallback,\n    toolbar: {\n      image: {\n        uploadCallback: uploadCallback\n      }\n    }\n  };\n\n  function handlePlaceChange(place) {\n    setState(_objectSpread(_objectSpread({}, state), {}, {\n      address: place.formatted_address,\n      lat: place.geometry.location.lat(),\n      lng: place.geometry.location.lng()\n    }));\n  }\n\n  function handlePlaceReset() {\n    setState(_objectSpread(_objectSpread({}, state), {}, {\n      address: \"\",\n      lat: \"\",\n      lng: \"\"\n    }));\n  }\n\n  function handleSettingChange(changedValues, allValues) {\n    console.log(\"handleSettingChange\", changedValues, allValues);\n    setState(_objectSpread(_objectSpread({}, state), allValues));\n  }\n\n  function handleMainInfoChange(changedValues, allValues) {\n    console.log(\"handleMainInfoChange\", changedValues, allValues);\n    setState(_objectSpread(_objectSpread({}, state), allValues));\n  }\n\n  function handleToggleAmenityOption(amenityId) {\n    console.log(\"amenityId\", state.amenities, amenityId);\n    let array = state.amenities;\n    let index = array.indexOf(amenityId);\n\n    if (index > -1) {\n      array.splice(index, 1);\n      setState(_objectSpread(_objectSpread({}, state), {}, {\n        amenities: array\n      }));\n    } else {\n      array.push(amenityId);\n      setState(_objectSpread(_objectSpread({}, state), {}, {\n        amenities: array\n      }));\n    }\n\n    console.log(\"handleToggleAmenityOption\", array, state);\n  }\n\n  function handleChangeRoom(values, id) {\n    const newRooms = state.rooms.map((room, index) => {\n      if (room.id === id) {\n        return _objectSpread(_objectSpread({}, room), values);\n      }\n\n      return room;\n    });\n    console.log(\"handleChangeRoom\", newRooms);\n    setState(_objectSpread(_objectSpread({}, state), {}, {\n      rooms: newRooms\n    }));\n  }\n\n  function handleAddRoom() {\n    const generatedId = new Date().getTime();\n    console.log(\"array\", array, generatedId);\n    let array = state.rooms;\n    array.push({\n      id: generatedId,\n      name: \"\",\n      bedType: \"Q\"\n    });\n    console.log(\"handleAddRoom\", array);\n    setState(_objectSpread(_objectSpread({}, state), {}, {\n      rooms: array\n    }));\n  }\n\n  function handleRemoveRoom(roomId) {\n    console.log(\"handleRemoveRoom\", roomId);\n    let array = state.rooms;\n    let index = array.findIndex(item => item.id === roomId);\n\n    if (index > -1) {\n      array[index].name = \"\";\n      array[index].bedType = \"\";\n      setState(_objectSpread(_objectSpread({}, state), {}, {\n        rooms: array\n      }));\n    }\n  }\n\n  function handleUploadSuccess(image) {\n    const {\n      galleryImgs\n    } = state;\n    galleryImgs.push(image);\n    setState(_objectSpread(_objectSpread({}, state), {}, {\n      galleryImgs\n    }));\n  }\n\n  function handleSortEnd({\n    oldIndex,\n    newIndex\n  }) {\n    const newArray = arrayMove(state.galleryImgs, oldIndex, newIndex);\n    setState(_objectSpread(_objectSpread({}, state), {}, {\n      galleryImgs: newArray\n    }));\n  }\n\n  function handleSelectFeatured(image) {\n    setState(_objectSpread(_objectSpread({}, state), {}, {\n      featuredImg: image\n    }));\n  }\n\n  const {\n    rowStyle,\n    colStyle\n  } = basicStyle;\n  return __jsx(LayoutWrapper, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 325,\n      columnNumber: 5\n    }\n  }, __jsx(Box, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 326,\n      columnNumber: 7\n    }\n  }, __jsx(_Button, {\n    type: \"primary\",\n    onClick: handleSave,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 327,\n      columnNumber: 9\n    }\n  }, \"Save\"), __jsx(_Button, {\n    type: \"default\",\n    onClick: handleReset,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 330,\n      columnNumber: 9\n    }\n  }, \"Reset\")), __jsx(\"div\", {\n    style: {\n      display: \"flex\",\n      flexFlow: \"row wrap\",\n      alignItems: \"flex-start\",\n      overflow: \"hidden\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 334,\n      columnNumber: 7\n    }\n  }), __jsx(_Row, {\n    style: rowStyle,\n    gutter: 0,\n    justify: \"start\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 342,\n      columnNumber: 7\n    }\n  }, __jsx(_Col, {\n    lg: 8,\n    md: 12,\n    sm: 24,\n    xs: 24,\n    style: colStyle,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 343,\n      columnNumber: 9\n    }\n  }, __jsx(\"div\", {\n    style: {\n      margin: \"0 20px\",\n      background: \"#fff\",\n      padding: 20\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 344,\n      columnNumber: 11\n    }\n  }, state.name !== \"\" && __jsx(Main, {\n    name: state.name,\n    bookervilleId: state.bookervilleId,\n    category: state.category,\n    onValuesChange: handleMainInfoChange,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 346,\n      columnNumber: 15\n    }\n  }), __jsx(Gallery, {\n    items: state.galleryImgs,\n    onSortEnd: handleSortEnd,\n    onUploadSuccess: handleUploadSuccess,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 354,\n      columnNumber: 13\n    }\n  }), __jsx(FeaturedImage, {\n    items: state.galleryImgs,\n    selectedItem: state.featuredImg,\n    onUploadSuccess: handleUploadSuccess,\n    onSelectImage: handleSelectFeatured,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 359,\n      columnNumber: 13\n    }\n  }))), __jsx(_Col, {\n    lg: 16,\n    md: 12,\n    sm: 24,\n    xs: 24,\n    style: colStyle,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 367,\n      columnNumber: 9\n    }\n  }, __jsx(Tabs, {\n    defaultActiveKey: \"1\",\n    onChange: callback,\n    style: {\n      margin: \"0 20px\",\n      background: \"#fff\",\n      padding: 20\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 368,\n      columnNumber: 11\n    }\n  }, [\"description\", \"neighbourhood\", \"transit\"].map(item => __jsx(TabPane, {\n    tab: item.charAt(0).toUpperCase() + item.slice(1),\n    key: item,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 374,\n      columnNumber: 15\n    }\n  }, (state === null || state === void 0 ? void 0 : state[item]) && __jsx(Editor, _extends({}, editorOption, {\n    html: state[item],\n    onEditorStateChange: html => setState(_objectSpread(_objectSpread({}, state), {}, {\n      [item]: html\n    })),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 379,\n      columnNumber: 19\n    }\n  })))), __jsx(TabPane, {\n    tab: \"Location\",\n    key: \"location\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 389,\n      columnNumber: 13\n    }\n  }, __jsx(Location, {\n    address: state.address,\n    center: {\n      lat: state.lat,\n      lng: state.lng\n    },\n    onPlaceChange: handlePlaceChange,\n    onReset: handlePlaceReset,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 390,\n      columnNumber: 15\n    }\n  })), __jsx(TabPane, {\n    tab: \"Setting\",\n    key: \"setting\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 400,\n      columnNumber: 13\n    }\n  }, __jsx(Setting, {\n    setting: state,\n    onValuesChange: handleSettingChange,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 401,\n      columnNumber: 15\n    }\n  })), __jsx(TabPane, {\n    tab: \"Amenity\",\n    key: \"amenity\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 403,\n      columnNumber: 13\n    }\n  }, __jsx(Amenity, {\n    amenities: state.amenities,\n    onToggleOption: handleToggleAmenityOption,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 404,\n      columnNumber: 15\n    }\n  })), __jsx(TabPane, {\n    tab: \"Bedtype\",\n    key: \"rooms\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 409,\n      columnNumber: 13\n    }\n  }, __jsx(Rooms, {\n    rooms: state.rooms,\n    onRoomChange: handleChangeRoom,\n    onAddRoom: handleAddRoom,\n    onRemoveRoom: handleRemoveRoom,\n    onValuesChange: handleSettingChange,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 410,\n      columnNumber: 15\n    }\n  })), __jsx(TabPane, {\n    tab: \"Pricing\",\n    key: \"pricing\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 418,\n      columnNumber: 13\n    }\n  }, __jsx(PricingCalendar, {\n    propertyId: propertyId,\n    defaultPrice: state.price,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 419,\n      columnNumber: 15\n    }\n  }))))));\n}","map":{"version":3,"sources":["E:/Projects/starsofboston/next-django/isomorphic-next/components/Admin/Property/EditProperty.js"],"names":["React","useEffect","LayoutWrapper","Box","Tabs","TabPane","Location","basicStyle","Setting","Main","Amenity","Rooms","arrayMove","Gallery","Editor","FeaturedImage","useDispatch","useSelector","propertyActions","PricingCalendar","uploadCallback","file","Promise","resolve","reject","xhr","XMLHttpRequest","open","setRequestHeader","data","FormData","append","send","addEventListener","response","JSON","parse","responseText","error","newProperty","name","category","bookervilleId","description","neighbourhood","transit","address","lat","lng","rooms","amenities","galleryImgs","featuredImg","similarProperties","price","minPrice","minMonthPrice","bathroomCount","bedroomCount","sleeps","minSleeps","cleaningFee","transactionFeeRate","taxRate","tour360","refundableAmount","furnished","rentalParking","petsConsidered","EditProperty","props","propertyId","state","setState","useState","dispatch","selectedItem","Properties","getProperty","id","bookerville_id","min_price","min_month_price","bedroom_count","bathroom_count","similar_properties","min_sleeps","cleaning_fee","transactionfee_rate","tax_rate","refundable_amount","renderOptionValue","rental_parking","pets_considered","property_rooms","map","room","bedType","bed_type","featured_img","gallery_imgs","console","log","callback","key","handleSave","property","makeRoomsArray","image","images","updateProperty","handleReset","value","array","editorOption","style","width","height","toolbarClassName","wrapperClassName","editorClassName","toolbar","handlePlaceChange","place","formatted_address","geometry","location","handlePlaceReset","handleSettingChange","changedValues","allValues","handleMainInfoChange","handleToggleAmenityOption","amenityId","index","indexOf","splice","push","handleChangeRoom","values","newRooms","handleAddRoom","generatedId","Date","getTime","handleRemoveRoom","roomId","findIndex","item","handleUploadSuccess","handleSortEnd","oldIndex","newIndex","newArray","handleSelectFeatured","rowStyle","colStyle","display","flexFlow","alignItems","overflow","margin","background","padding","charAt","toUpperCase","slice","html"],"mappings":";;;;;;;;;;;;;;AAAA,OAAOA,KAAP,IAAgBC,SAAhB,QAAiC,OAAjC;AACA,OAAOC,aAAP,MAA0B,uCAA1B;AACA,OAAOC,GAAP,MAAgB,6BAAhB;AACA,OAAOC,IAAP,IAAeC,OAAf,QAA8B,iCAA9B;AACA,OAAOC,QAAP,MAAqB,8CAArB;AACA,OAAOC,UAAP,MAAuB,8BAAvB;AAEA,OAAOC,OAAP,MAAoB,4CAApB;AACA,OAAOC,IAAP,MAAiB,sCAAjB;AACA,OAAOC,OAAP,MAAoB,4CAApB;AACA,OAAOC,KAAP,MAAkB,uCAAlB;AACA,OAAOC,SAAP,MAAsB,YAAtB;AACA,OAAOC,OAAP,MAAoB,4CAApB;AACA,OAAOC,MAAP,MAAmB,0CAAnB;AACA,OAAOC,aAAP,MAA0B,wDAA1B;AACA,SAASC,WAAT,EAAsBC,WAAtB,QAAyC,aAAzC;AACA,OAAOC,eAAP,MAA4B,2BAA5B;AACA,OAAOC,eAAP,MAA4B,4DAA5B;;AAEA,SAASC,cAAT,CAAwBC,IAAxB,EAA8B;AAC5B,SAAO,IAAIC,OAAJ,CAAY,CAACC,OAAD,EAAUC,MAAV,KAAqB;AACtC,UAAMC,GAAG,GAAG,IAAIC,cAAJ,EAAZ;AACAD,IAAAA,GAAG,CAACE,IAAJ,CAAS,MAAT,EAAiB,+BAAjB;AACAF,IAAAA,GAAG,CAACG,gBAAJ,CAAqB,eAArB,EAAsC,2BAAtC;AACA,UAAMC,IAAI,GAAG,IAAIC,QAAJ,EAAb;AACAD,IAAAA,IAAI,CAACE,MAAL,CAAY,OAAZ,EAAqBV,IAArB;AACAI,IAAAA,GAAG,CAACO,IAAJ,CAASH,IAAT;AACAJ,IAAAA,GAAG,CAACQ,gBAAJ,CAAqB,MAArB,EAA6B,MAAM;AACjC,YAAMC,QAAQ,GAAGC,IAAI,CAACC,KAAL,CAAWX,GAAG,CAACY,YAAf,CAAjB;AACAd,MAAAA,OAAO,CAACW,QAAD,CAAP;AACD,KAHD;AAIAT,IAAAA,GAAG,CAACQ,gBAAJ,CAAqB,OAArB,EAA8B,MAAM;AAClC,YAAMK,KAAK,GAAGH,IAAI,CAACC,KAAL,CAAWX,GAAG,CAACY,YAAf,CAAd;AACAb,MAAAA,MAAM,CAACc,KAAD,CAAN;AACD,KAHD;AAID,GAfM,CAAP;AAgBD;;AAED,MAAMC,WAAW,GAAG;AAClBC,EAAAA,IAAI,EAAE,EADY;AAElBC,EAAAA,QAAQ,EAAE,EAFQ;AAGlBC,EAAAA,aAAa,EAAE,EAHG;AAIlBC,EAAAA,WAAW,EAAE,EAJK;AAKlBC,EAAAA,aAAa,EAAE,EALG;AAMlBC,EAAAA,OAAO,EAAE,EANS;AAOlBC,EAAAA,OAAO,EAAE,EAPS;AAQlBC,EAAAA,GAAG,EAAE,EARa;AASlBC,EAAAA,GAAG,EAAE,EATa;AAUlBC,EAAAA,KAAK,EAAE,EAVW;AAWlBC,EAAAA,SAAS,EAAE,EAXO;AAYlBC,EAAAA,WAAW,EAAE,EAZK;AAalBC,EAAAA,WAAW,EAAE,IAbK;AAclBC,EAAAA,iBAAiB,EAAE,EAdD;AAgBlBC,EAAAA,KAAK,EAAE,EAhBW;AAiBlBC,EAAAA,QAAQ,EAAE,EAjBQ;AAkBlBC,EAAAA,aAAa,EAAE,EAlBG;AAmBlBC,EAAAA,aAAa,EAAE,EAnBG;AAoBlBC,EAAAA,YAAY,EAAE,EApBI;AAqBlBC,EAAAA,MAAM,EAAE,EArBU;AAsBlBC,EAAAA,SAAS,EAAE,CAtBO;AAuBlBC,EAAAA,WAAW,EAAE,EAvBK;AAwBlBC,EAAAA,kBAAkB,EAAE,EAxBF;AAyBlBC,EAAAA,OAAO,EAAE,EAzBS;AA0BlBC,EAAAA,OAAO,EAAE,EA1BS;AA2BlBC,EAAAA,gBAAgB,EAAE,EA3BA;AA4BlBC,EAAAA,SAAS,EAAE,IA5BO;AA6BlBC,EAAAA,aAAa,EAAE,IA7BG;AA8BlBC,EAAAA,cAAc,EAAE;AA9BE,CAApB;AAiCA,eAAe,SAASC,YAAT,CAAsBC,KAAtB,EAA6B;AAC1C,QAAM;AAAEC,IAAAA;AAAF,MAAiBD,KAAvB;AACA,QAAM,CAACE,KAAD,EAAQC,QAAR,IAAoBzE,KAAK,CAAC0E,QAAN,CAAenC,WAAf,CAA1B;AAEA,QAAMoC,QAAQ,GAAG3D,WAAW,EAA5B;AACA,QAAM;AAAE4D,IAAAA;AAAF,MAAmB3D,WAAW,CAAEuD,KAAD,IAAWA,KAAK,CAACK,UAAlB,CAApC;AAEA5E,EAAAA,SAAS,CAAC,MAAM;AACd0E,IAAAA,QAAQ,CAACzD,eAAe,CAAC4D,WAAhB,CAA4BP,UAA5B,CAAD,CAAR;AACD,GAFQ,EAEN,EAFM,CAAT;AAIAtE,EAAAA,SAAS,CAAC,MAAM;AACd,QAAK,GAAE2E,YAAY,CAACG,EAAG,EAAnB,KAA0B,GAAER,UAAW,EAA3C,EAA8C;AAC5CE,MAAAA,QAAQ,CAAC;AACPM,QAAAA,EAAE,EAAEH,YAAY,CAACG,EADV;AAEPrC,QAAAA,aAAa,EAAEkC,YAAY,CAACI,cAFrB;AAGPxC,QAAAA,IAAI,EAAEoC,YAAY,CAACpC,IAHZ;AAIPC,QAAAA,QAAQ,EAAG,GAAEmC,YAAY,CAACnC,QAAS,EAJ5B;AAKPK,QAAAA,OAAO,EAAE8B,YAAY,CAAC9B,OALf;AAMPC,QAAAA,GAAG,EAAE6B,YAAY,CAAC7B,GANX;AAOPC,QAAAA,GAAG,EAAE4B,YAAY,CAAC5B,GAPX;AAQPL,QAAAA,WAAW,EAAEiC,YAAY,CAACjC,WARnB;AASPC,QAAAA,aAAa,EAAEgC,YAAY,CAAChC,aATrB;AAUPC,QAAAA,OAAO,EAAE+B,YAAY,CAAC/B,OAVf;AAWPS,QAAAA,KAAK,EAAEsB,YAAY,CAACtB,KAXb;AAYPC,QAAAA,QAAQ,EAAEqB,YAAY,CAACK,SAZhB;AAaPzB,QAAAA,aAAa,EAAEoB,YAAY,CAACM,eAbrB;AAcPxB,QAAAA,YAAY,EAAEkB,YAAY,CAACO,aAdpB;AAeP1B,QAAAA,aAAa,EAAEmB,YAAY,CAACQ,cAfrB;AAgBP/B,QAAAA,iBAAiB,EAAEuB,YAAY,CAACS,kBAhBzB;AAiBP1B,QAAAA,MAAM,EAAEiB,YAAY,CAACjB,MAjBd;AAkBPC,QAAAA,SAAS,EAAEgB,YAAY,CAACU,UAlBjB;AAmBPzB,QAAAA,WAAW,EAAEe,YAAY,CAACW,YAnBnB;AAoBPzB,QAAAA,kBAAkB,EAAEc,YAAY,CAACY,mBApB1B;AAqBPzB,QAAAA,OAAO,EAAEa,YAAY,CAACa,QArBf;AAsBPxB,QAAAA,gBAAgB,EAAEW,YAAY,CAACc,iBAtBxB;AAuBP1B,QAAAA,OAAO,EAAEY,YAAY,CAACZ,OAvBf;AAwBPE,QAAAA,SAAS,EAAEyB,iBAAiB,CAACf,YAAY,CAACV,SAAd,CAxBrB;AAyBPC,QAAAA,aAAa,EAAEwB,iBAAiB,CAACf,YAAY,CAACgB,cAAd,CAzBzB;AA0BPxB,QAAAA,cAAc,EAAEuB,iBAAiB,CAACf,YAAY,CAACiB,eAAd,CA1B1B;AA2BP5C,QAAAA,KAAK,EAAE2B,YAAY,CAACkB,cAAb,CAA4BC,GAA5B,CAAiCC,IAAD,KAAW;AAChDjB,UAAAA,EAAE,EAAEiB,IAAI,CAACjB,EADuC;AAEhDvC,UAAAA,IAAI,EAAEwD,IAAI,CAACxD,IAFqC;AAGhDyD,UAAAA,OAAO,EAAED,IAAI,CAACE;AAHkC,SAAX,CAAhC,CA3BA;AAgCPhD,QAAAA,SAAS,EAAE0B,YAAY,CAAC1B,SAhCjB;AAiCPE,QAAAA,WAAW,EAAEwB,YAAY,CAACuB,YAjCnB;AAkCPhD,QAAAA,WAAW,EAAEyB,YAAY,CAACwB;AAlCnB,OAAD,CAAR;AAoCD;AACF,GAvCQ,EAuCN,CAACxB,YAAD,CAvCM,CAAT;AAyCA3E,EAAAA,SAAS,CAAC,MAAM;AACdoG,IAAAA,OAAO,CAACC,GAAR,CAAY,OAAZ,EAAqB9B,KAArB;AACD,GAFQ,EAEN,CAACA,KAAD,CAFM,CAAT;;AAIA,WAAS+B,QAAT,CAAkBC,GAAlB,EAAuB;AACrBH,IAAAA,OAAO,CAACC,GAAR,CAAYE,GAAZ;AACD;;AAED,WAASC,UAAT,GAAsB;AACpB,UAAMC,QAAQ,GAAG;AACf3B,MAAAA,EAAE,EAAEH,YAAY,CAACG,EADF;AAEfC,MAAAA,cAAc,EAAER,KAAK,CAAC9B,aAFP;AAGfF,MAAAA,IAAI,EAAEgC,KAAK,CAAChC,IAHG;AAIfC,MAAAA,QAAQ,EAAE+B,KAAK,CAAC/B,QAJD;AAKfK,MAAAA,OAAO,EAAE0B,KAAK,CAAC1B,OALA;AAMfC,MAAAA,GAAG,EAAEyB,KAAK,CAACzB,GANI;AAOfC,MAAAA,GAAG,EAAEwB,KAAK,CAACxB,GAPI;AAQfL,MAAAA,WAAW,EAAE6B,KAAK,CAAC7B,WARJ;AASfC,MAAAA,aAAa,EAAE4B,KAAK,CAAC5B,aATN;AAUfC,MAAAA,OAAO,EAAE2B,KAAK,CAAC3B,OAVA;AAWfS,MAAAA,KAAK,EAAEkB,KAAK,CAAClB,KAXE;AAYf2B,MAAAA,SAAS,EAAET,KAAK,CAACjB,QAZF;AAaf2B,MAAAA,eAAe,EAAEV,KAAK,CAAChB,aAbR;AAcf2B,MAAAA,aAAa,EAAEX,KAAK,CAACd,YAdN;AAef0B,MAAAA,cAAc,EAAEZ,KAAK,CAACf,aAfP;AAgBf4B,MAAAA,kBAAkB,EAAEb,KAAK,CAACnB,iBAhBX;AAiBfM,MAAAA,MAAM,EAAEa,KAAK,CAACb,MAjBC;AAkBf2B,MAAAA,UAAU,EAAEd,KAAK,CAACZ,SAlBH;AAmBf2B,MAAAA,YAAY,EAAEf,KAAK,CAACX,WAnBL;AAoBf2B,MAAAA,mBAAmB,EAAEhB,KAAK,CAACV,kBApBZ;AAqBf2B,MAAAA,QAAQ,EAAEjB,KAAK,CAACT,OArBD;AAsBf2B,MAAAA,iBAAiB,EAAElB,KAAK,CAACP,gBAtBV;AAuBfD,MAAAA,OAAO,EAAEQ,KAAK,CAACR,OAvBA;AAwBfE,MAAAA,SAAS,EAAEM,KAAK,CAACN,SAxBF;AAyBf0B,MAAAA,cAAc,EAAEpB,KAAK,CAACL,aAzBP;AA0Bf0B,MAAAA,eAAe,EAAErB,KAAK,CAACJ,cA1BR;AA2Bf0B,MAAAA,cAAc,EAAEa,cAAc,EA3Bf;AA4BfzD,MAAAA,SAAS,EAAEsB,KAAK,CAACtB,SA5BF;AA6BfiD,MAAAA,YAAY,EAAE3B,KAAK,CAACpB,WAAN,CAAkB2B,EA7BjB;AA8BfqB,MAAAA,YAAY,EAAE5B,KAAK,CAACrB,WAAN,CAAkB4C,GAAlB,CAAuBa,KAAD,IAAWA,KAAK,CAAC7B,EAAvC,CA9BC;AA+Bf8B,MAAAA,MAAM,EAAErC,KAAK,CAACqC;AA/BC,KAAjB;AAiCAlC,IAAAA,QAAQ,CAACzD,eAAe,CAAC4F,cAAhB,CAA+BJ,QAA/B,CAAD,CAAR;AACD;;AAED,WAASK,WAAT,GAAuB;AACrBtC,IAAAA,QAAQ,CAAC;AAAElC,MAAAA;AAAF,KAAD,CAAR;AACD;;AAED,WAASoD,iBAAT,CAA2BqB,KAA3B,EAAkC;AAChC,QAAIA,KAAK,KAAK,IAAd,EAAoB;AAClB,aAAO,GAAP;AACD;;AACD,WAAO,GAAP;AACD;;AAED,WAASL,cAAT,GAA0B;AACxB,QAAIM,KAAK,GAAGzC,KAAK,CAACvB,KAAN,CAAY8C,GAAZ,CAAiBC,IAAD,IAAU;AACpC,aAAOA,IAAI,CAACjB,EAAL,GAAU,KAAV,GACH;AACEvC,QAAAA,IAAI,EAAEwD,IAAI,CAACxD,IAAL,GAAYwD,IAAI,CAACxD,IAAjB,GAAwB,EADhC;AAEE0D,QAAAA,QAAQ,EAAEF,IAAI,CAACC,OAAL,GAAeD,IAAI,CAACC,OAApB,GAA8B;AAF1C,OADG,GAKH;AACElB,QAAAA,EAAE,EAAEiB,IAAI,CAACjB,EADX;AAEEvC,QAAAA,IAAI,EAAEwD,IAAI,CAACxD,IAAL,GAAYwD,IAAI,CAACxD,IAAjB,GAAwB,EAFhC;AAGE0D,QAAAA,QAAQ,EAAEF,IAAI,CAACC,OAAL,GAAeD,IAAI,CAACC,OAApB,GAA8B;AAH1C,OALJ;AAUD,KAXW,CAAZ;AAYA,WAAOgB,KAAP;AACD;;AAED,QAAMC,YAAY,GAAG;AACnBC,IAAAA,KAAK,EAAE;AAAEC,MAAAA,KAAK,EAAE,KAAT;AAAgBC,MAAAA,MAAM,EAAE;AAAxB,KADY;AAEnBC,IAAAA,gBAAgB,EAAE,cAFC;AAGnBC,IAAAA,gBAAgB,EAAE,cAHC;AAInBC,IAAAA,eAAe,EAAE,aAJE;AAKnBpG,IAAAA,cAAc,EAAEA,cALG;AAMnBqG,IAAAA,OAAO,EAAE;AAAEb,MAAAA,KAAK,EAAE;AAAExF,QAAAA,cAAc,EAAEA;AAAlB;AAAT;AANU,GAArB;;AASA,WAASsG,iBAAT,CAA2BC,KAA3B,EAAkC;AAChClD,IAAAA,QAAQ,iCACHD,KADG;AAEN1B,MAAAA,OAAO,EAAE6E,KAAK,CAACC,iBAFT;AAGN7E,MAAAA,GAAG,EAAE4E,KAAK,CAACE,QAAN,CAAeC,QAAf,CAAwB/E,GAAxB,EAHC;AAINC,MAAAA,GAAG,EAAE2E,KAAK,CAACE,QAAN,CAAeC,QAAf,CAAwB9E,GAAxB;AAJC,OAAR;AAMD;;AAED,WAAS+E,gBAAT,GAA4B;AAC1BtD,IAAAA,QAAQ,iCACHD,KADG;AAEN1B,MAAAA,OAAO,EAAE,EAFH;AAGNC,MAAAA,GAAG,EAAE,EAHC;AAINC,MAAAA,GAAG,EAAE;AAJC,OAAR;AAMD;;AAED,WAASgF,mBAAT,CAA6BC,aAA7B,EAA4CC,SAA5C,EAAuD;AACrD7B,IAAAA,OAAO,CAACC,GAAR,CAAY,qBAAZ,EAAmC2B,aAAnC,EAAkDC,SAAlD;AACAzD,IAAAA,QAAQ,iCACHD,KADG,GAEH0D,SAFG,EAAR;AAID;;AAED,WAASC,oBAAT,CAA8BF,aAA9B,EAA6CC,SAA7C,EAAwD;AACtD7B,IAAAA,OAAO,CAACC,GAAR,CAAY,sBAAZ,EAAoC2B,aAApC,EAAmDC,SAAnD;AACAzD,IAAAA,QAAQ,iCACHD,KADG,GAEH0D,SAFG,EAAR;AAID;;AAED,WAASE,yBAAT,CAAmCC,SAAnC,EAA8C;AAC5ChC,IAAAA,OAAO,CAACC,GAAR,CAAY,WAAZ,EAAyB9B,KAAK,CAACtB,SAA/B,EAA0CmF,SAA1C;AACA,QAAIpB,KAAK,GAAGzC,KAAK,CAACtB,SAAlB;AACA,QAAIoF,KAAK,GAAGrB,KAAK,CAACsB,OAAN,CAAcF,SAAd,CAAZ;;AACA,QAAIC,KAAK,GAAG,CAAC,CAAb,EAAgB;AACdrB,MAAAA,KAAK,CAACuB,MAAN,CAAaF,KAAb,EAAoB,CAApB;AACA7D,MAAAA,QAAQ,iCACHD,KADG;AAENtB,QAAAA,SAAS,EAAE+D;AAFL,SAAR;AAID,KAND,MAMO;AACLA,MAAAA,KAAK,CAACwB,IAAN,CAAWJ,SAAX;AACA5D,MAAAA,QAAQ,iCACHD,KADG;AAENtB,QAAAA,SAAS,EAAE+D;AAFL,SAAR;AAID;;AACDZ,IAAAA,OAAO,CAACC,GAAR,CAAY,2BAAZ,EAAyCW,KAAzC,EAAgDzC,KAAhD;AACD;;AAED,WAASkE,gBAAT,CAA0BC,MAA1B,EAAkC5D,EAAlC,EAAsC;AACpC,UAAM6D,QAAQ,GAAGpE,KAAK,CAACvB,KAAN,CAAY8C,GAAZ,CAAgB,CAACC,IAAD,EAAOsC,KAAP,KAAiB;AAChD,UAAItC,IAAI,CAACjB,EAAL,KAAYA,EAAhB,EAAoB;AAClB,+CACKiB,IADL,GAEK2C,MAFL;AAID;;AACD,aAAO3C,IAAP;AACD,KARgB,CAAjB;AASAK,IAAAA,OAAO,CAACC,GAAR,CAAY,kBAAZ,EAAgCsC,QAAhC;AACAnE,IAAAA,QAAQ,iCAAMD,KAAN;AAAavB,MAAAA,KAAK,EAAE2F;AAApB,OAAR;AACD;;AAED,WAASC,aAAT,GAAyB;AACvB,UAAMC,WAAW,GAAG,IAAIC,IAAJ,GAAWC,OAAX,EAApB;AACA3C,IAAAA,OAAO,CAACC,GAAR,CAAY,OAAZ,EAAqBW,KAArB,EAA4B6B,WAA5B;AACA,QAAI7B,KAAK,GAAGzC,KAAK,CAACvB,KAAlB;AACAgE,IAAAA,KAAK,CAACwB,IAAN,CAAW;AACT1D,MAAAA,EAAE,EAAE+D,WADK;AAETtG,MAAAA,IAAI,EAAE,EAFG;AAGTyD,MAAAA,OAAO,EAAE;AAHA,KAAX;AAKAI,IAAAA,OAAO,CAACC,GAAR,CAAY,eAAZ,EAA6BW,KAA7B;AACAxC,IAAAA,QAAQ,iCACHD,KADG;AAENvB,MAAAA,KAAK,EAAEgE;AAFD,OAAR;AAID;;AAED,WAASgC,gBAAT,CAA0BC,MAA1B,EAAkC;AAChC7C,IAAAA,OAAO,CAACC,GAAR,CAAY,kBAAZ,EAAgC4C,MAAhC;AACA,QAAIjC,KAAK,GAAGzC,KAAK,CAACvB,KAAlB;AACA,QAAIqF,KAAK,GAAGrB,KAAK,CAACkC,SAAN,CAAiBC,IAAD,IAAUA,IAAI,CAACrE,EAAL,KAAYmE,MAAtC,CAAZ;;AACA,QAAIZ,KAAK,GAAG,CAAC,CAAb,EAAgB;AACdrB,MAAAA,KAAK,CAACqB,KAAD,CAAL,CAAa9F,IAAb,GAAoB,EAApB;AACAyE,MAAAA,KAAK,CAACqB,KAAD,CAAL,CAAarC,OAAb,GAAuB,EAAvB;AACAxB,MAAAA,QAAQ,iCACHD,KADG;AAENvB,QAAAA,KAAK,EAAEgE;AAFD,SAAR;AAID;AACF;;AAED,WAASoC,mBAAT,CAA6BzC,KAA7B,EAAoC;AAClC,UAAM;AAAEzD,MAAAA;AAAF,QAAkBqB,KAAxB;AACArB,IAAAA,WAAW,CAACsF,IAAZ,CAAiB7B,KAAjB;AACAnC,IAAAA,QAAQ,iCAAMD,KAAN;AAAarB,MAAAA;AAAb,OAAR;AACD;;AAED,WAASmG,aAAT,CAAuB;AAAEC,IAAAA,QAAF;AAAYC,IAAAA;AAAZ,GAAvB,EAA+C;AAC7C,UAAMC,QAAQ,GAAG7I,SAAS,CAAC4D,KAAK,CAACrB,WAAP,EAAoBoG,QAApB,EAA8BC,QAA9B,CAA1B;AAEA/E,IAAAA,QAAQ,iCACHD,KADG;AAENrB,MAAAA,WAAW,EAAEsG;AAFP,OAAR;AAID;;AAED,WAASC,oBAAT,CAA8B9C,KAA9B,EAAqC;AACnCnC,IAAAA,QAAQ,iCAAMD,KAAN;AAAapB,MAAAA,WAAW,EAAEwD;AAA1B,OAAR;AACD;;AAED,QAAM;AAAE+C,IAAAA,QAAF;AAAYC,IAAAA;AAAZ,MAAyBrJ,UAA/B;AAEA,SACE,MAAC,aAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACE,MAAC,GAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACE;AAAQ,IAAA,IAAI,EAAC,SAAb;AAAuB,IAAA,OAAO,EAAEkG,UAAhC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,YADF,EAIE;AAAQ,IAAA,IAAI,EAAC,SAAb;AAAuB,IAAA,OAAO,EAAEM,WAAhC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,aAJF,CADF,EASE;AACE,IAAA,KAAK,EAAE;AACL8C,MAAAA,OAAO,EAAE,MADJ;AAELC,MAAAA,QAAQ,EAAE,UAFL;AAGLC,MAAAA,UAAU,EAAE,YAHP;AAILC,MAAAA,QAAQ,EAAE;AAJL,KADT;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IATF,EAiBE;AAAK,IAAA,KAAK,EAAEL,QAAZ;AAAsB,IAAA,MAAM,EAAE,CAA9B;AAAiC,IAAA,OAAO,EAAC,OAAzC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACE;AAAK,IAAA,EAAE,EAAE,CAAT;AAAY,IAAA,EAAE,EAAE,EAAhB;AAAoB,IAAA,EAAE,EAAE,EAAxB;AAA4B,IAAA,EAAE,EAAE,EAAhC;AAAoC,IAAA,KAAK,EAAEC,QAA3C;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACE;AAAK,IAAA,KAAK,EAAE;AAAEK,MAAAA,MAAM,EAAE,QAAV;AAAoBC,MAAAA,UAAU,EAAE,MAAhC;AAAwCC,MAAAA,OAAO,EAAE;AAAjD,KAAZ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACG3F,KAAK,CAAChC,IAAN,KAAe,EAAf,IACC,MAAC,IAAD;AACE,IAAA,IAAI,EAAEgC,KAAK,CAAChC,IADd;AAEE,IAAA,aAAa,EAAEgC,KAAK,CAAC9B,aAFvB;AAGE,IAAA,QAAQ,EAAE8B,KAAK,CAAC/B,QAHlB;AAIE,IAAA,cAAc,EAAE0F,oBAJlB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAFJ,EAUE,MAAC,OAAD;AACE,IAAA,KAAK,EAAE3D,KAAK,CAACrB,WADf;AAEE,IAAA,SAAS,EAAEmG,aAFb;AAGE,IAAA,eAAe,EAAED,mBAHnB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAVF,EAeE,MAAC,aAAD;AACE,IAAA,KAAK,EAAE7E,KAAK,CAACrB,WADf;AAEE,IAAA,YAAY,EAAEqB,KAAK,CAACpB,WAFtB;AAGE,IAAA,eAAe,EAAEiG,mBAHnB;AAIE,IAAA,aAAa,EAAEK,oBAJjB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAfF,CADF,CADF,EAyBE;AAAK,IAAA,EAAE,EAAE,EAAT;AAAa,IAAA,EAAE,EAAE,EAAjB;AAAqB,IAAA,EAAE,EAAE,EAAzB;AAA6B,IAAA,EAAE,EAAE,EAAjC;AAAqC,IAAA,KAAK,EAAEE,QAA5C;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACE,MAAC,IAAD;AACE,IAAA,gBAAgB,EAAC,GADnB;AAEE,IAAA,QAAQ,EAAErD,QAFZ;AAGE,IAAA,KAAK,EAAE;AAAE0D,MAAAA,MAAM,EAAE,QAAV;AAAoBC,MAAAA,UAAU,EAAE,MAAhC;AAAwCC,MAAAA,OAAO,EAAE;AAAjD,KAHT;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAKG,CAAC,aAAD,EAAgB,eAAhB,EAAiC,SAAjC,EAA4CpE,GAA5C,CAAiDqD,IAAD,IAC/C,MAAC,OAAD;AACE,IAAA,GAAG,EAAEA,IAAI,CAACgB,MAAL,CAAY,CAAZ,EAAeC,WAAf,KAA+BjB,IAAI,CAACkB,KAAL,CAAW,CAAX,CADtC;AAEE,IAAA,GAAG,EAAElB,IAFP;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAIG,CAAA5E,KAAK,SAAL,IAAAA,KAAK,WAAL,YAAAA,KAAK,CAAG4E,IAAH,CAAL,KACC,MAAC,MAAD,eACMlC,YADN;AAEE,IAAA,IAAI,EAAE1C,KAAK,CAAC4E,IAAD,CAFb;AAGE,IAAA,mBAAmB,EAAGmB,IAAD,IACnB9F,QAAQ,iCAAMD,KAAN;AAAa,OAAC4E,IAAD,GAAQmB;AAArB,OAJZ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KALJ,CADD,CALH,EAqBE,MAAC,OAAD;AAAS,IAAA,GAAG,EAAC,UAAb;AAAwB,IAAA,GAAG,EAAC,UAA5B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACE,MAAC,QAAD;AACE,IAAA,OAAO,EAAE/F,KAAK,CAAC1B,OADjB;AAEE,IAAA,MAAM,EAAE;AACNC,MAAAA,GAAG,EAAEyB,KAAK,CAACzB,GADL;AAENC,MAAAA,GAAG,EAAEwB,KAAK,CAACxB;AAFL,KAFV;AAME,IAAA,aAAa,EAAE0E,iBANjB;AAOE,IAAA,OAAO,EAAEK,gBAPX;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IADF,CArBF,EAgCE,MAAC,OAAD;AAAS,IAAA,GAAG,EAAC,SAAb;AAAuB,IAAA,GAAG,EAAC,SAA3B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACE,MAAC,OAAD;AAAS,IAAA,OAAO,EAAEvD,KAAlB;AAAyB,IAAA,cAAc,EAAEwD,mBAAzC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IADF,CAhCF,EAmCE,MAAC,OAAD;AAAS,IAAA,GAAG,EAAC,SAAb;AAAuB,IAAA,GAAG,EAAC,SAA3B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACE,MAAC,OAAD;AACE,IAAA,SAAS,EAAExD,KAAK,CAACtB,SADnB;AAEE,IAAA,cAAc,EAAEkF,yBAFlB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IADF,CAnCF,EAyCE,MAAC,OAAD;AAAS,IAAA,GAAG,EAAC,SAAb;AAAuB,IAAA,GAAG,EAAC,OAA3B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACE,MAAC,KAAD;AACE,IAAA,KAAK,EAAE5D,KAAK,CAACvB,KADf;AAEE,IAAA,YAAY,EAAEyF,gBAFhB;AAGE,IAAA,SAAS,EAAEG,aAHb;AAIE,IAAA,YAAY,EAAEI,gBAJhB;AAKE,IAAA,cAAc,EAAEjB,mBALlB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IADF,CAzCF,EAkDE,MAAC,OAAD;AAAS,IAAA,GAAG,EAAC,SAAb;AAAuB,IAAA,GAAG,EAAC,SAA3B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACE,MAAC,eAAD;AACE,IAAA,UAAU,EAAEzD,UADd;AAEE,IAAA,YAAY,EAAEC,KAAK,CAAClB,KAFtB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IADF,CAlDF,CADF,CAzBF,CAjBF,CADF;AAyGD","sourcesContent":["import React, { useEffect } from \"react\";\r\nimport LayoutWrapper from \"@iso/components/utility/layoutWrapper\";\r\nimport Box from \"@iso/components/utility/box\";\r\nimport Tabs, { TabPane } from \"@iso/components/uielements/tabs\";\r\nimport Location from \"@components/Admin/Property/Location/Location\";\r\nimport basicStyle from \"@iso/assets/styles/constants\";\r\nimport { Row, Col, Button } from \"antd\";\r\nimport Setting from \"@components/Admin/Property/Setting/Setting\";\r\nimport Main from \"@components/Admin/Property/Main/Main\";\r\nimport Amenity from \"@components/Admin/Property/Amenity/Amenity\";\r\nimport Rooms from \"@components/Admin/Property/Room/Rooms\";\r\nimport arrayMove from \"array-move\";\r\nimport Gallery from \"@components/Admin/Property/Gallery/Gallery\";\r\nimport Editor from \"@components/Admin/Property/Editor/Editor\";\r\nimport FeaturedImage from \"@components/Admin/Property/FeaturedImage/FeaturedImage\";\r\nimport { useDispatch, useSelector } from \"react-redux\";\r\nimport propertyActions from \"@redux/properties/actions\";\r\nimport PricingCalendar from \"@components/Admin/Property/PricingCalendar/PricingCalendar\";\r\n\r\nfunction uploadCallback(file) {\r\n  return new Promise((resolve, reject) => {\r\n    const xhr = new XMLHttpRequest();\r\n    xhr.open(\"POST\", \"https://api.imgur.com/3/image\");\r\n    xhr.setRequestHeader(\"Authorization\", \"Client-ID 8d26ccd12712fca\");\r\n    const data = new FormData();\r\n    data.append(\"image\", file);\r\n    xhr.send(data);\r\n    xhr.addEventListener(\"load\", () => {\r\n      const response = JSON.parse(xhr.responseText);\r\n      resolve(response);\r\n    });\r\n    xhr.addEventListener(\"error\", () => {\r\n      const error = JSON.parse(xhr.responseText);\r\n      reject(error);\r\n    });\r\n  });\r\n}\r\n\r\nconst newProperty = {\r\n  name: \"\",\r\n  category: \"\",\r\n  bookervilleId: \"\",\r\n  description: \"\",\r\n  neighbourhood: \"\",\r\n  transit: \"\",\r\n  address: \"\",\r\n  lat: \"\",\r\n  lng: \"\",\r\n  rooms: [],\r\n  amenities: [],\r\n  galleryImgs: [],\r\n  featuredImg: null,\r\n  similarProperties: [],\r\n\r\n  price: \"\",\r\n  minPrice: \"\",\r\n  minMonthPrice: \"\",\r\n  bathroomCount: \"\",\r\n  bedroomCount: \"\",\r\n  sleeps: \"\",\r\n  minSleeps: 2,\r\n  cleaningFee: \"\",\r\n  transactionFeeRate: \"\",\r\n  taxRate: \"\",\r\n  tour360: \"\",\r\n  refundableAmount: \"\",\r\n  furnished: true,\r\n  rentalParking: true,\r\n  petsConsidered: true,\r\n};\r\n\r\nexport default function EditProperty(props) {\r\n  const { propertyId } = props;\r\n  const [state, setState] = React.useState(newProperty);\r\n\r\n  const dispatch = useDispatch();\r\n  const { selectedItem } = useSelector((state) => state.Properties);\r\n\r\n  useEffect(() => {\r\n    dispatch(propertyActions.getProperty(propertyId));\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    if (`${selectedItem.id}` === `${propertyId}`) {\r\n      setState({\r\n        id: selectedItem.id,\r\n        bookervilleId: selectedItem.bookerville_id,\r\n        name: selectedItem.name,\r\n        category: `${selectedItem.category}`,\r\n        address: selectedItem.address,\r\n        lat: selectedItem.lat,\r\n        lng: selectedItem.lng,\r\n        description: selectedItem.description,\r\n        neighbourhood: selectedItem.neighbourhood,\r\n        transit: selectedItem.transit,\r\n        price: selectedItem.price,\r\n        minPrice: selectedItem.min_price,\r\n        minMonthPrice: selectedItem.min_month_price,\r\n        bedroomCount: selectedItem.bedroom_count,\r\n        bathroomCount: selectedItem.bathroom_count,\r\n        similarProperties: selectedItem.similar_properties,\r\n        sleeps: selectedItem.sleeps,\r\n        minSleeps: selectedItem.min_sleeps,\r\n        cleaningFee: selectedItem.cleaning_fee,\r\n        transactionFeeRate: selectedItem.transactionfee_rate,\r\n        taxRate: selectedItem.tax_rate,\r\n        refundableAmount: selectedItem.refundable_amount,\r\n        tour360: selectedItem.tour360,\r\n        furnished: renderOptionValue(selectedItem.furnished),\r\n        rentalParking: renderOptionValue(selectedItem.rental_parking),\r\n        petsConsidered: renderOptionValue(selectedItem.pets_considered),\r\n        rooms: selectedItem.property_rooms.map((room) => ({\r\n          id: room.id,\r\n          name: room.name,\r\n          bedType: room.bed_type,\r\n        })),\r\n        amenities: selectedItem.amenities,\r\n        featuredImg: selectedItem.featured_img,\r\n        galleryImgs: selectedItem.gallery_imgs,\r\n      });\r\n    }\r\n  }, [selectedItem]);\r\n\r\n  useEffect(() => {\r\n    console.log(\"state\", state);\r\n  }, [state]);\r\n\r\n  function callback(key) {\r\n    console.log(key);\r\n  }\r\n\r\n  function handleSave() {\r\n    const property = {\r\n      id: selectedItem.id,\r\n      bookerville_id: state.bookervilleId,\r\n      name: state.name,\r\n      category: state.category,\r\n      address: state.address,\r\n      lat: state.lat,\r\n      lng: state.lng,\r\n      description: state.description,\r\n      neighbourhood: state.neighbourhood,\r\n      transit: state.transit,\r\n      price: state.price,\r\n      min_price: state.minPrice,\r\n      min_month_price: state.minMonthPrice,\r\n      bedroom_count: state.bedroomCount,\r\n      bathroom_count: state.bathroomCount,\r\n      similar_properties: state.similarProperties,\r\n      sleeps: state.sleeps,\r\n      min_sleeps: state.minSleeps,\r\n      cleaning_fee: state.cleaningFee,\r\n      transactionfee_rate: state.transactionFeeRate,\r\n      tax_rate: state.taxRate,\r\n      refundable_amount: state.refundableAmount,\r\n      tour360: state.tour360,\r\n      furnished: state.furnished,\r\n      rental_parking: state.rentalParking,\r\n      pets_considered: state.petsConsidered,\r\n      property_rooms: makeRoomsArray(),\r\n      amenities: state.amenities,\r\n      featured_img: state.featuredImg.id,\r\n      gallery_imgs: state.galleryImgs.map((image) => image.id),\r\n      images: state.images,\r\n    };\r\n    dispatch(propertyActions.updateProperty(property));\r\n  }\r\n\r\n  function handleReset() {\r\n    setState({ newProperty });\r\n  }\r\n\r\n  function renderOptionValue(value) {\r\n    if (value === true) {\r\n      return \"1\";\r\n    }\r\n    return \"0\";\r\n  }\r\n\r\n  function makeRoomsArray() {\r\n    let array = state.rooms.map((room) => {\r\n      return room.id > 10000\r\n        ? {\r\n            name: room.name ? room.name : \"\",\r\n            bed_type: room.bedType ? room.bedType : \"\",\r\n          }\r\n        : {\r\n            id: room.id,\r\n            name: room.name ? room.name : \"\",\r\n            bed_type: room.bedType ? room.bedType : \"\",\r\n          };\r\n    });\r\n    return array;\r\n  }\r\n\r\n  const editorOption = {\r\n    style: { width: \"90%\", height: \"70%\" },\r\n    toolbarClassName: \"home-toolbar\",\r\n    wrapperClassName: \"home-wrapper\",\r\n    editorClassName: \"home-editor\",\r\n    uploadCallback: uploadCallback,\r\n    toolbar: { image: { uploadCallback: uploadCallback } },\r\n  };\r\n\r\n  function handlePlaceChange(place) {\r\n    setState({\r\n      ...state,\r\n      address: place.formatted_address,\r\n      lat: place.geometry.location.lat(),\r\n      lng: place.geometry.location.lng(),\r\n    });\r\n  }\r\n\r\n  function handlePlaceReset() {\r\n    setState({\r\n      ...state,\r\n      address: \"\",\r\n      lat: \"\",\r\n      lng: \"\",\r\n    });\r\n  }\r\n\r\n  function handleSettingChange(changedValues, allValues) {\r\n    console.log(\"handleSettingChange\", changedValues, allValues);\r\n    setState({\r\n      ...state,\r\n      ...allValues,\r\n    });\r\n  }\r\n\r\n  function handleMainInfoChange(changedValues, allValues) {\r\n    console.log(\"handleMainInfoChange\", changedValues, allValues);\r\n    setState({\r\n      ...state,\r\n      ...allValues,\r\n    });\r\n  }\r\n\r\n  function handleToggleAmenityOption(amenityId) {\r\n    console.log(\"amenityId\", state.amenities, amenityId);\r\n    let array = state.amenities;\r\n    let index = array.indexOf(amenityId);\r\n    if (index > -1) {\r\n      array.splice(index, 1);\r\n      setState({\r\n        ...state,\r\n        amenities: array,\r\n      });\r\n    } else {\r\n      array.push(amenityId);\r\n      setState({\r\n        ...state,\r\n        amenities: array,\r\n      });\r\n    }\r\n    console.log(\"handleToggleAmenityOption\", array, state);\r\n  }\r\n\r\n  function handleChangeRoom(values, id) {\r\n    const newRooms = state.rooms.map((room, index) => {\r\n      if (room.id === id) {\r\n        return {\r\n          ...room,\r\n          ...values,\r\n        };\r\n      }\r\n      return room;\r\n    });\r\n    console.log(\"handleChangeRoom\", newRooms);\r\n    setState({ ...state, rooms: newRooms });\r\n  }\r\n\r\n  function handleAddRoom() {\r\n    const generatedId = new Date().getTime();\r\n    console.log(\"array\", array, generatedId);\r\n    let array = state.rooms;\r\n    array.push({\r\n      id: generatedId,\r\n      name: \"\",\r\n      bedType: \"Q\",\r\n    });\r\n    console.log(\"handleAddRoom\", array);\r\n    setState({\r\n      ...state,\r\n      rooms: array,\r\n    });\r\n  }\r\n\r\n  function handleRemoveRoom(roomId) {\r\n    console.log(\"handleRemoveRoom\", roomId);\r\n    let array = state.rooms;\r\n    let index = array.findIndex((item) => item.id === roomId);\r\n    if (index > -1) {\r\n      array[index].name = \"\";\r\n      array[index].bedType = \"\";\r\n      setState({\r\n        ...state,\r\n        rooms: array,\r\n      });\r\n    }\r\n  }\r\n\r\n  function handleUploadSuccess(image) {\r\n    const { galleryImgs } = state;\r\n    galleryImgs.push(image);\r\n    setState({ ...state, galleryImgs });\r\n  }\r\n\r\n  function handleSortEnd({ oldIndex, newIndex }) {\r\n    const newArray = arrayMove(state.galleryImgs, oldIndex, newIndex);\r\n\r\n    setState({\r\n      ...state,\r\n      galleryImgs: newArray,\r\n    });\r\n  }\r\n\r\n  function handleSelectFeatured(image) {\r\n    setState({ ...state, featuredImg: image });\r\n  }\r\n\r\n  const { rowStyle, colStyle } = basicStyle;\r\n\r\n  return (\r\n    <LayoutWrapper>\r\n      <Box>\r\n        <Button type=\"primary\" onClick={handleSave}>\r\n          Save\r\n        </Button>\r\n        <Button type=\"default\" onClick={handleReset}>\r\n          Reset\r\n        </Button>\r\n      </Box>\r\n      <div\r\n        style={{\r\n          display: \"flex\",\r\n          flexFlow: \"row wrap\",\r\n          alignItems: \"flex-start\",\r\n          overflow: \"hidden\",\r\n        }}\r\n      ></div>\r\n      <Row style={rowStyle} gutter={0} justify=\"start\">\r\n        <Col lg={8} md={12} sm={24} xs={24} style={colStyle}>\r\n          <div style={{ margin: \"0 20px\", background: \"#fff\", padding: 20 }}>\r\n            {state.name !== \"\" && (\r\n              <Main\r\n                name={state.name}\r\n                bookervilleId={state.bookervilleId}\r\n                category={state.category}\r\n                onValuesChange={handleMainInfoChange}\r\n              />\r\n            )}\r\n\r\n            <Gallery\r\n              items={state.galleryImgs}\r\n              onSortEnd={handleSortEnd}\r\n              onUploadSuccess={handleUploadSuccess}\r\n            />\r\n            <FeaturedImage\r\n              items={state.galleryImgs}\r\n              selectedItem={state.featuredImg}\r\n              onUploadSuccess={handleUploadSuccess}\r\n              onSelectImage={handleSelectFeatured}\r\n            />\r\n          </div>\r\n        </Col>\r\n        <Col lg={16} md={12} sm={24} xs={24} style={colStyle}>\r\n          <Tabs\r\n            defaultActiveKey=\"1\"\r\n            onChange={callback}\r\n            style={{ margin: \"0 20px\", background: \"#fff\", padding: 20 }}\r\n          >\r\n            {[\"description\", \"neighbourhood\", \"transit\"].map((item) => (\r\n              <TabPane\r\n                tab={item.charAt(0).toUpperCase() + item.slice(1)}\r\n                key={item}\r\n              >\r\n                {state?.[item] && (\r\n                  <Editor\r\n                    {...editorOption}\r\n                    html={state[item]}\r\n                    onEditorStateChange={(html) =>\r\n                      setState({ ...state, [item]: html })\r\n                    }\r\n                  />\r\n                )}\r\n              </TabPane>\r\n            ))}\r\n            <TabPane tab=\"Location\" key=\"location\">\r\n              <Location\r\n                address={state.address}\r\n                center={{\r\n                  lat: state.lat,\r\n                  lng: state.lng,\r\n                }}\r\n                onPlaceChange={handlePlaceChange}\r\n                onReset={handlePlaceReset}\r\n              />\r\n            </TabPane>\r\n            <TabPane tab=\"Setting\" key=\"setting\">\r\n              <Setting setting={state} onValuesChange={handleSettingChange} />\r\n            </TabPane>\r\n            <TabPane tab=\"Amenity\" key=\"amenity\">\r\n              <Amenity\r\n                amenities={state.amenities}\r\n                onToggleOption={handleToggleAmenityOption}\r\n              />\r\n            </TabPane>\r\n            <TabPane tab=\"Bedtype\" key=\"rooms\">\r\n              <Rooms\r\n                rooms={state.rooms}\r\n                onRoomChange={handleChangeRoom}\r\n                onAddRoom={handleAddRoom}\r\n                onRemoveRoom={handleRemoveRoom}\r\n                onValuesChange={handleSettingChange}\r\n              />\r\n            </TabPane>\r\n            <TabPane tab=\"Pricing\" key=\"pricing\">\r\n              <PricingCalendar\r\n                propertyId={propertyId}\r\n                defaultPrice={state.price}\r\n              />\r\n            </TabPane>\r\n          </Tabs>\r\n        </Col>\r\n      </Row>\r\n    </LayoutWrapper>\r\n  );\r\n}\r\n"]},"metadata":{},"sourceType":"module"}