{"ast":null,"code":"import _Button from \"antd/lib/button\";\nimport _Row from \"antd/lib/row\";\nimport _Col from \"antd/lib/col\";\nvar __jsx = React.createElement;\nimport React, { useContext, useEffect, useState } from 'react';\nimport BookingCalculationForm from './BookingCalculationForm';\nimport Card from \"@iso/ui/UI/Card/Card\";\nimport PropertyGalleryModal from \"@components/Guest/Property/ImageGallery/ImageGalleryModal\";\nimport tourIcon from \"@iso/assets/images/icon/icons_360.svg\";\nimport { CardHeaderWrapper } from \"@components/Guest/Property/Reservation/Reservation.style\";\nimport { BookingContext } from \"@context/BookingProvider\";\nimport { useRouter } from 'next/router';\nimport { BACKEND_URL } from \"../../../../env-config\";\nimport Loader from '@iso/components/utility/loader';\nimport { notification } from \"@iso/components\";\n\nconst CardHeader = ({\n  name,\n  images,\n  isModalShowing,\n  setIsModalShowing\n}) => {\n  const headerCarousel = __jsx(React.Fragment, null, __jsx(_Row, null, images ? [0, 1, 2].map(index => {\n    if (images[index] === undefined) {\n      return __jsx(_Col, {\n        key: index,\n        lg: 8\n      }, __jsx(\"div\", {\n        style: {\n          backgroundImage: `url(${images[0].file})`,\n          backgroundPosition: 'center center',\n          backgroundSize: \"cover\",\n          height: 100\n        }\n      }));\n    }\n\n    return __jsx(_Col, {\n      key: index,\n      lg: 8\n    }, __jsx(\"div\", {\n      style: {\n        backgroundImage: `url(${images[index].file})`,\n        backgroundPosition: 'center center',\n        backgroundSize: \"cover\",\n        height: 100\n      }\n    }));\n  }) : __jsx(Loader, null)));\n\n  return __jsx(CardHeaderWrapper, null, headerCarousel, __jsx(_Row, null, __jsx(\"div\", {\n    className: \"header-buttons-wrapper\"\n  }, __jsx(_Button, {\n    type: \"secondary\",\n    size: \"large\"\n  }, __jsx(\"img\", {\n    src: tourIcon,\n    alt: \"tour\"\n  })), __jsx(_Button, {\n    type: \"secondary\",\n    size: \"large\",\n    onClick: () => setIsModalShowing(true)\n  }, \"Browse Photos\"))), __jsx(\"h3\", null, name), __jsx(PropertyGalleryModal, {\n    isModalShowing: isModalShowing,\n    setIsModalShowing: setIsModalShowing,\n    images: images\n  }));\n};\n\nexport default function BookingWidget(props) {\n  const {\n    disabled\n  } = props;\n  const {\n    0: isLoading,\n    1: setIsLoading\n  } = useState(null);\n  const {\n    state,\n    dispatch\n  } = useContext(BookingContext);\n  const router = useRouter();\n  useEffect(() => {\n    if (state.propertySlug === null) {\n      router.push('/listing');\n      return;\n    }\n\n    getPropertyDetail(state.propertySlug);\n  }, []);\n  const {\n    0: property,\n    1: setProperty\n  } = useState(null);\n  const {\n    0: isModalShowing,\n    1: setIsModalShowing\n  } = useState(false);\n\n  const getPropertyDetail = async propertySlug => {\n    setIsLoading(true);\n\n    try {\n      const res = await fetch(`${BACKEND_URL}/api/accommodation/property/listing/${propertySlug}`);\n      const property = await res.json();\n      setProperty(property);\n      dispatch({\n        type: 'UPDATE_BOOKING_INFORMATION',\n        payload: {\n          bookervilleId: property.bookerville_id\n        }\n      });\n      setIsLoading(false);\n    } catch (e) {\n      notification('warning', 'Server error while fetching property detail');\n    }\n  };\n\n  return __jsx(Card, {\n    className: \"reservation_sidebar\",\n    header: !isLoading && property ? __jsx(CardHeader, {\n      name: property.name,\n      images: property.gallery_imgs,\n      isModalShowing: isModalShowing,\n      setIsModalShowing: setIsModalShowing\n    }) : __jsx(Loader, null),\n    footer: null\n  }, !isLoading && property ? __jsx(BookingCalculationForm, {\n    disabled: disabled,\n    property: property\n  }) : __jsx(Loader, null));\n}","map":null,"metadata":{},"sourceType":"module"}