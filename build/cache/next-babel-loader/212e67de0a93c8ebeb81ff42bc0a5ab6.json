{"ast":null,"code":"import _Row from \"antd/lib/row\";\nimport _Button from \"antd/lib/button\";\nimport _extends from \"@babel/runtime/helpers/esm/extends\";\nimport _Col from \"antd/lib/col\";\nimport _Input from \"antd/lib/input\";\nimport _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _Form from \"antd/lib/form\";\nimport _slicedToArray from \"@babel/runtime/helpers/esm/slicedToArray\";\nimport _DatePicker from \"antd/lib/date-picker\";\nvar __jsx = React.createElement;\nimport React, { useState } from 'react';\nimport Container from \"@iso/ui/UI/Container/Container\";\nimport PhoneInput from 'react-phone-input-2';\nimport _ from \"lodash\";\nimport Box from \"@iso/ui/Box/Box\";\nimport styled from \"styled-components\";\nimport { palette } from \"styled-tools\";\nimport { BACKEND_URL } from \"../../../env-config\";\nimport { notification } from \"@iso/components\";\nimport LocationSearchAutoComplete from \"@components/Guest/ApplicationForm/LocationSearchAutoComplete\";\nimport moment from 'moment';\nvar RangePicker = _DatePicker.RangePicker;\nvar formItemLayout = {\n  labelCol: {\n    span: 24\n  },\n  wrapperCol: {\n    span: 24\n  }\n};\nvar rangeConfig = {\n  rules: [{\n    type: 'array',\n    required: true,\n    message: 'Please select dates!'\n  }]\n};\nvar textConfig = {\n  rules: [{\n    required: true,\n    message: 'Please fill out this field!'\n  }]\n};\nvar ApplicationFormWrapper = styled.div.withConfig({\n  displayName: \"ApplicationForm__ApplicationFormWrapper\",\n  componentId: \"sc-11a2zj-0\"\n})([\".rental-application-block{padding:50px 0 100px;h2{text-align:center;color:\", \"}}.autocomplete-container{width:100%;position:relative;.place-input-wrapper{position:relative;input{width:100%;height:48px;border:2px solid #e4e7ea;border-radius:4px;transition:border-color .15s ease-in-out,box-shadow .15s ease-in-out;&:focus,&:active{border:2px solid \", \";box-shadow:none !important;}&::placeholder{font-size:16px;}}svg{position:absolute;right:1rem;top:0.7rem;}}.autocomplete-dropdown-container{position:absolute;top:40px;border-left:1px solid lightgray;border-right:1px solid lightgray;font-size:1rem;z-index:9999;width:100%;.suggestion-item{border-bottom:1px solid lightgray;padding:0.5rem;cursor:pointer;background:#fff;svg{margin:0 10px;}&.active{background-color:lightgray;}}}}.form-action-buttons{display:flex;justify-content:center;button:first-child{margin-right:20px;}}\"], palette('primary', 0), palette('warning', 0));\n\nvar PhoneNumberInput = function PhoneNumberInput(_ref) {\n  var _ref$value = _ref.value,\n      value = _ref$value === void 0 ? {} : _ref$value,\n      onChange = _ref.onChange;\n\n  var triggerChange = function triggerChange(changedValue) {\n    console.log(\"PhoneNumberInput\", value, changedValue, onChange);\n    onChange(changedValue);\n  };\n\n  return __jsx(PhoneInput // enableSearch={true}\n  , {\n    country: 'us',\n    value: value,\n    placeholder: \"   Your Phone Number\",\n    onChange: function onChange(value, country, e, formattedValue) {\n      triggerChange(formattedValue);\n    },\n    onBlur: function onBlur() {},\n    inputStyle: {\n      width: '100%',\n      height: '48px'\n    },\n    isValid: function isValid(inputNumber, country, countries) {\n      return countries.some(function (country) {\n        return _.startsWith(inputNumber, country.dialCode) || _.startsWith(country.dialCode, inputNumber);\n      });\n    }\n  });\n};\n\nvar AddressInput = function AddressInput(_ref2) {\n  var _ref2$value = _ref2.value,\n      value = _ref2$value === void 0 ? {} : _ref2$value,\n      onChange = _ref2.onChange;\n\n  var triggerChange = function triggerChange(changedValue) {\n    console.log(\"AddressInput\", value, changedValue, onChange);\n    onChange(changedValue);\n  };\n\n  return __jsx(LocationSearchAutoComplete, {\n    value: value,\n    onChange: function onChange(place) {\n      triggerChange(place.formatted_address);\n    },\n    onReset: function onReset() {\n      return onChange('');\n    }\n  });\n};\n\nfunction ApplicationForm(_ref3) {\n  var posts = _ref3.posts;\n\n  var _useState = useState(false),\n      submitted = _useState[0],\n      setSubmitted = _useState[1];\n\n  var _Form$useForm = _Form.useForm(),\n      _Form$useForm2 = _slicedToArray(_Form$useForm, 1),\n      form = _Form$useForm2[0];\n\n  var onFinish = /*#__PURE__*/function () {\n    var _ref4 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(values) {\n      var res, data;\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              values.occupancy[0] = moment(values.occupancy[0]).format('YYYY/MM/DD');\n              values.occupancy[1] = moment(values.occupancy[1]).format('YYYY/MM/DD');\n              values.formerlordoccupancy[0] = moment(values.formerlordoccupancy[0]).format('YYYY/MM/DD');\n              values.formerlordoccupancy[1] = moment(values.formerlordoccupancy[1]).format('YYYY/MM/DD');\n              _context.prev = 4;\n              _context.next = 7;\n              return fetch(\"\".concat(BACKEND_URL, \"/api/users/apply_email\"), {\n                method: 'POST',\n                headers: {\n                  'Content-Type': 'application/json'\n                },\n                body: JSON.stringify(values)\n              });\n\n            case 7:\n              res = _context.sent;\n              _context.next = 10;\n              return res.json();\n\n            case 10:\n              data = _context.sent;\n\n              if (res.status === 400) {\n                notification('warning', 'Bad request');\n              }\n\n              if (res.ok) {\n                notification('success', 'Your rental application form has been submitted! We will process it and get back to you ASAP!');\n              }\n\n              _context.next = 18;\n              break;\n\n            case 15:\n              _context.prev = 15;\n              _context.t0 = _context[\"catch\"](4);\n              notification('warning', 'Server error while handling booking information');\n\n            case 18:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee, null, [[4, 15]]);\n    }));\n\n    return function onFinish(_x) {\n      return _ref4.apply(this, arguments);\n    };\n  }();\n\n  var onValuesChange = function onValuesChange(v1, v2) {\n    console.log(\"onValuesChange\", v1, v2);\n  };\n\n  var onReset = function onReset() {\n    form.resetFields();\n  };\n\n  return __jsx(ApplicationFormWrapper, null, __jsx(Box, {\n    as: \"section\",\n    className: \"main-background-2\"\n  }), __jsx(Box, {\n    as: \"section\",\n    className: \"rental-application-block\"\n  }, __jsx(Container, null, __jsx(\"h2\", null, \"Rental Application Form\"), __jsx(_Form, _extends({\n    form: form,\n    name: \"rental-application-form\",\n    className: \"rental-application-form\",\n    onFinish: onFinish,\n    scrollToFirstError: true,\n    onValuesChange: onValuesChange\n  }, formItemLayout, {\n    initialValues: {\n      name: '',\n      address: 'asdf',\n      phonenumber: '1',\n      email: '',\n      occupancy: '',\n      people: '',\n      pets: '',\n      contact: '',\n      employer: '',\n      occupation: '',\n      salary: '',\n      reason: '',\n      extradetail: '',\n      lordname: '',\n      lordaddress: '',\n      lordphonenumber: '',\n      formerlordname: '',\n      formerlordaddress: '',\n      formerlordoccupancy: '',\n      formerlordphonenumber: ''\n    }\n  }), __jsx(_Row, {\n    gutter: [32, 32]\n  }, __jsx(_Col, {\n    sm: 24,\n    lg: 12\n  }, __jsx(_Form.Item, {\n    label: \"Name\",\n    name: \"name\",\n    className: \"isoInputWrapper\",\n    rules: [{\n      required: true,\n      message: 'This field is required'\n    }]\n  }, __jsx(_Input, {\n    name: \"name\",\n    size: \"large\"\n  }))), __jsx(_Col, {\n    sm: 24,\n    lg: 12\n  }, __jsx(_Form.Item, {\n    label: \"Permanent address\",\n    name: \"address\",\n    className: \"isoInputWrapper\",\n    rules: [{\n      required: true,\n      message: 'This field is required'\n    }]\n  }, __jsx(AddressInput, null))), __jsx(_Col, {\n    sm: 24,\n    lg: 12\n  }, __jsx(_Form.Item, {\n    label: \"Phone number\",\n    name: \"phonenumber\",\n    className: \"isoInputWrapper\",\n    rules: [{\n      required: true,\n      message: 'This field is required'\n    }]\n  }, __jsx(PhoneNumberInput, null))), __jsx(_Col, {\n    lg: 12,\n    sm: 24\n  }, __jsx(_Form.Item, {\n    label: \"Email\",\n    name: \"email\",\n    className: \"isoInputWrapper\",\n    rules: [{\n      type: 'email',\n      message: 'Email is not valid'\n    }, {\n      required: true,\n      message: 'Please input your email'\n    }]\n  }, __jsx(_Input, {\n    placeholder: \"Email\",\n    size: \"large\"\n  }))), __jsx(_Col, {\n    lg: 12,\n    sm: 24\n  }, __jsx(_Form.Item, _extends({\n    label: \"Dates of occupancy (Start Date - End Date)\",\n    name: \"occupancy\",\n    className: \"isoInputWrapper\"\n  }, rangeConfig), __jsx(RangePicker, {\n    size: \"large\"\n  }))), __jsx(_Col, {\n    lg: 12,\n    sm: 24\n  }, __jsx(_Form.Item, _extends({\n    label: \"How many adults, and how many children\",\n    name: \"people\"\n  }, textConfig), __jsx(_Input, {\n    size: \"large\"\n  }))), __jsx(_Col, {\n    lg: 12,\n    sm: 24\n  }, __jsx(_Form.Item, _extends({\n    label: \"Pets - if yes, please list type and breed\",\n    name: \"pets\"\n  }, textConfig), __jsx(_Input, {\n    size: \"large\"\n  }))), __jsx(_Col, {\n    lg: 12,\n    sm: 24\n  }, __jsx(_Form.Item, _extends({\n    label: \"Contact in case of an emergency\",\n    name: \"contact\"\n  }, textConfig), __jsx(_Input, {\n    size: \"large\"\n  }))), __jsx(_Col, {\n    lg: 12,\n    sm: 24\n  }, __jsx(_Form.Item, _extends({\n    label: \"Employer? (if student, please list name of university)\",\n    name: \"employer\"\n  }, textConfig), __jsx(_Input, {\n    size: \"large\"\n  }))), __jsx(_Col, {\n    lg: 12,\n    sm: 24\n  }, __jsx(_Form.Item, _extends({\n    label: \"Occupation\",\n    name: \"occupation\"\n  }, textConfig), __jsx(_Input, {\n    size: \"large\"\n  }))), __jsx(_Col, {\n    lg: 12,\n    sm: 24\n  }, __jsx(_Form.Item, _extends({\n    label: \"Salary (Please state currency)\",\n    name: \"salary\"\n  }, textConfig), __jsx(_Input, {\n    size: \"large\"\n  }))), __jsx(_Col, {\n    lg: 12,\n    sm: 24\n  }, __jsx(_Form.Item, _extends({\n    label: \"Reason for your visit\",\n    name: \"reason\"\n  }, textConfig), __jsx(_Input, {\n    size: \"large\"\n  }))), __jsx(_Col, {\n    lg: 12,\n    sm: 24\n  }, __jsx(_Form.Item, _extends({\n    label: \"Anything else we should know of\",\n    name: \"extradetail\"\n  }, textConfig), __jsx(_Input, {\n    size: \"large\"\n  }))), __jsx(_Col, {\n    lg: 24,\n    sm: 24\n  }, __jsx(\"h5\", null, \"Present Landlord\")), __jsx(_Col, {\n    lg: 8,\n    sm: 24\n  }, __jsx(_Form.Item, _extends({\n    label: \"Name\",\n    name: \"lordname\"\n  }, textConfig), __jsx(_Input, {\n    size: \"large\"\n  }))), __jsx(_Col, {\n    lg: 8,\n    sm: 24\n  }, __jsx(_Form.Item, _extends({\n    label: \"Complete Address\",\n    name: \"lordaddress\"\n  }, textConfig), __jsx(AddressInput, null))), __jsx(_Col, {\n    lg: 8,\n    sm: 24\n  }, __jsx(_Form.Item, _extends({\n    label: \"Phone Number\",\n    name: \"lordphonenumber\"\n  }, textConfig), __jsx(PhoneNumberInput, null))), __jsx(_Col, {\n    lg: 24,\n    sm: 24\n  }, __jsx(\"h5\", null, \"Former Landlord\")), __jsx(_Col, {\n    lg: 8,\n    sm: 24\n  }, __jsx(_Form.Item, _extends({\n    label: \"Name\",\n    name: \"formerlordname\"\n  }, textConfig), __jsx(_Input, {\n    size: \"large\"\n  }))), __jsx(_Col, {\n    lg: 8,\n    sm: 24\n  }, __jsx(_Form.Item, _extends({\n    label: \"Occupancy\",\n    name: \"formerlordoccupancy\"\n  }, rangeConfig), __jsx(RangePicker, {\n    size: \"large\"\n  }))), __jsx(_Col, {\n    lg: 8,\n    sm: 24\n  }, __jsx(_Form.Item, _extends({\n    label: \"Complete Address\",\n    name: \"formerlordaddress\"\n  }, textConfig), __jsx(AddressInput, null))), __jsx(_Col, {\n    lg: 8,\n    sm: 24\n  }, __jsx(_Form.Item, _extends({\n    label: \"Phone Number\",\n    name: \"formerlordphonenumber\"\n  }, textConfig), __jsx(PhoneNumberInput, null))), __jsx(_Col, {\n    sm: 24,\n    className: \"form-action-buttons\"\n  }, __jsx(_Button, {\n    type: \"primary\",\n    htmlType: \"submit\",\n    size: \"large\"\n  }, \"Submit\"), __jsx(_Button, {\n    type: \"default\",\n    size: \"large\",\n    onClick: onReset\n  }, \"Reset\")))))));\n}\n\nexport default ApplicationForm;","map":null,"metadata":{},"sourceType":"module"}