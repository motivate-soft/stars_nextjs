{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _Button from \"antd/lib/button\";\nimport _Row from \"antd/lib/row\";\nimport _Col from \"antd/lib/col\";\nvar __jsx = React.createElement;\nimport React, { useContext, useEffect, useState } from 'react';\nimport BookingCalculationForm from './BookingCalculationForm';\nimport Card from \"@iso/ui/UI/Card/Card\";\nimport PropertyGalleryModal from \"@components/Guest/Property/ImageGallery/ImageGalleryModal\";\nimport tourIcon from \"@iso/assets/images/icon/icons_360.svg\";\nimport { CardHeaderWrapper } from \"@components/Guest/Property/Reservation/Reservation.style\";\nimport { BookingContext } from \"@context/BookingProvider\";\nimport { useRouter } from 'next/router';\nimport { BACKEND_URL } from \"../../../../env-config\";\nimport Loader from '@iso/components/utility/loader';\nimport { notification } from \"@iso/components\";\n\nvar CardHeader = function CardHeader(_ref) {\n  var name = _ref.name,\n      images = _ref.images,\n      isModalShowing = _ref.isModalShowing,\n      setIsModalShowing = _ref.setIsModalShowing;\n\n  var headerCarousel = __jsx(React.Fragment, null, __jsx(_Row, null, images ? [0, 1, 2].map(function (index) {\n    if (images[index] === undefined) {\n      return __jsx(_Col, {\n        key: index,\n        lg: 8\n      }, __jsx(\"div\", {\n        style: {\n          backgroundImage: \"url(\".concat(images[0].file, \")\"),\n          backgroundPosition: 'center center',\n          backgroundSize: \"cover\",\n          height: 100\n        }\n      }));\n    }\n\n    return __jsx(_Col, {\n      key: index,\n      lg: 8\n    }, __jsx(\"div\", {\n      style: {\n        backgroundImage: \"url(\".concat(images[index].file, \")\"),\n        backgroundPosition: 'center center',\n        backgroundSize: \"cover\",\n        height: 100\n      }\n    }));\n  }) : __jsx(Loader, null)));\n\n  return __jsx(CardHeaderWrapper, null, headerCarousel, __jsx(_Row, null, __jsx(\"div\", {\n    className: \"header-buttons-wrapper\"\n  }, __jsx(_Button, {\n    type: \"secondary\",\n    size: \"large\"\n  }, __jsx(\"img\", {\n    src: tourIcon,\n    alt: \"tour\"\n  })), __jsx(_Button, {\n    type: \"secondary\",\n    size: \"large\",\n    onClick: function onClick() {\n      return setIsModalShowing(true);\n    }\n  }, \"Browse Photos\"))), __jsx(\"h3\", null, name), __jsx(PropertyGalleryModal, {\n    isModalShowing: isModalShowing,\n    setIsModalShowing: setIsModalShowing,\n    images: images\n  }));\n};\n\nexport default function BookingWidget(props) {\n  var disabled = props.disabled;\n\n  var _useState = useState(null),\n      isLoading = _useState[0],\n      setIsLoading = _useState[1];\n\n  var _useContext = useContext(BookingContext),\n      state = _useContext.state,\n      dispatch = _useContext.dispatch;\n\n  var router = useRouter();\n  useEffect(function () {\n    if (state.propertySlug === null) {\n      router.push('/listing');\n      return;\n    }\n\n    getPropertyDetail(state.propertySlug);\n  }, []);\n\n  var _useState2 = useState(null),\n      property = _useState2[0],\n      setProperty = _useState2[1];\n\n  var _useState3 = useState(false),\n      isModalShowing = _useState3[0],\n      setIsModalShowing = _useState3[1];\n\n  var getPropertyDetail = /*#__PURE__*/function () {\n    var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(propertySlug) {\n      var res, _property;\n\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              setIsLoading(true);\n              _context.prev = 1;\n              _context.next = 4;\n              return fetch(\"\".concat(BACKEND_URL, \"/api/accommodation/property/listing/\").concat(propertySlug));\n\n            case 4:\n              res = _context.sent;\n              _context.next = 7;\n              return res.json();\n\n            case 7:\n              _property = _context.sent;\n              setProperty(_property);\n              dispatch({\n                type: 'UPDATE_BOOKING_INFORMATION',\n                payload: {\n                  bookervilleId: _property.bookerville_id\n                }\n              });\n              setIsLoading(false);\n              _context.next = 16;\n              break;\n\n            case 13:\n              _context.prev = 13;\n              _context.t0 = _context[\"catch\"](1);\n              notification('warning', 'Server error while fetching property detail');\n\n            case 16:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee, null, [[1, 13]]);\n    }));\n\n    return function getPropertyDetail(_x) {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n\n  return __jsx(Card, {\n    className: \"reservation_sidebar\",\n    header: !isLoading && property ? __jsx(CardHeader, {\n      name: property.name,\n      images: property.gallery_imgs,\n      isModalShowing: isModalShowing,\n      setIsModalShowing: setIsModalShowing\n    }) : __jsx(Loader, null),\n    footer: null\n  }, !isLoading && property ? __jsx(BookingCalculationForm, {\n    disabled: disabled,\n    property: property\n  }) : __jsx(Loader, null));\n}","map":null,"metadata":{},"sourceType":"module"}