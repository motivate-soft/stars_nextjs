{"ast":null,"code":"import _Row from \"antd/lib/row\";\nimport _Col from \"antd/lib/col\";\nimport _Button from \"antd/lib/button\";\nvar _jsxFileName = \"E:\\\\Projects\\\\starsofboston\\\\next-django\\\\isomorphic-next\\\\components\\\\Admin\\\\Property\\\\EditProperty.js\";\nvar __jsx = React.createElement;\n\nfunction _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nimport React, { useEffect } from \"react\";\nimport LayoutWrapper from \"@iso/components/utility/layoutWrapper\";\nimport Box from \"@iso/components/utility/box\";\nimport Tabs, { TabPane } from \"@iso/components/uielements/tabs\";\nimport Location from \"@components/Admin/Property/Location/Location\";\nimport basicStyle from \"@iso/assets/styles/constants\";\nimport Setting from \"@components/Admin/Property/Setting/Setting\";\nimport Main from \"@components/Admin/Property/Main/Main\";\nimport Amenity from \"@components/Admin/Property/Amenity/Amenity\";\nimport Rooms from \"@components/Admin/Property/Room/Rooms\";\nimport arrayMove from \"array-move\";\nimport Gallery from \"@components/Admin/Property/Gallery/Gallery\";\nimport Editor from \"@components/Admin/Property/Editor/Editor\";\nimport FeaturedImage from \"@components/Admin/Property/FeaturedImage/FeaturedImage\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport propertyActions from \"@redux/properties/actions\";\nimport PricingCalendar from \"@components/Admin/Property/PricingCalendar/PricingCalendar\";\nimport SimilarProperty from \"@components/Admin/Property/SimilarProperty/SimilarProperty\";\n\nfunction uploadCallback(file) {\n  return new Promise((resolve, reject) => {\n    const xhr = new XMLHttpRequest();\n    xhr.open(\"POST\", \"https://api.imgur.com/3/image\");\n    xhr.setRequestHeader(\"Authorization\", \"Client-ID 8d26ccd12712fca\");\n    const data = new FormData();\n    data.append(\"image\", file);\n    xhr.send(data);\n    xhr.addEventListener(\"load\", () => {\n      const response = JSON.parse(xhr.responseText);\n      resolve(response);\n    });\n    xhr.addEventListener(\"error\", () => {\n      const error = JSON.parse(xhr.responseText);\n      reject(error);\n    });\n  });\n}\n\nconst newProperty = {\n  name: \"\",\n  category: \"\",\n  bookervilleId: \"\",\n  description: \"\",\n  neighbourhood: \"\",\n  transit: \"\",\n  address: \"\",\n  lat: \"\",\n  lng: \"\",\n  rooms: [],\n  amenities: [],\n  galleryImgs: [],\n  featuredImg: null,\n  similarProperties: [],\n  price: \"\",\n  minPrice: \"\",\n  minMonthPrice: \"\",\n  bathroomCount: \"\",\n  bedroomCount: \"\",\n  sleeps: \"\",\n  minSleeps: 2,\n  cleaningFee: \"\",\n  transactionFeeRate: \"\",\n  taxRate: \"\",\n  tour360: \"\",\n  refundableAmount: \"\",\n  furnished: true,\n  rentalParking: true,\n  petsConsidered: true\n};\nexport default function EditProperty(props) {\n  const {\n    propertyId\n  } = props;\n  const [state, setState] = React.useState(newProperty);\n  const dispatch = useDispatch();\n  const {\n    selectedItem\n  } = useSelector(state => state.Properties);\n  const editorOption = {\n    style: {\n      width: \"90%\",\n      height: \"70%\"\n    },\n    toolbarClassName: \"home-toolbar\",\n    wrapperClassName: \"home-wrapper\",\n    editorClassName: \"home-editor\",\n    uploadCallback: uploadCallback,\n    toolbar: {\n      image: {\n        uploadCallback: uploadCallback\n      }\n    }\n  };\n  useEffect(() => {\n    dispatch(propertyActions.getProperty(propertyId));\n  }, []);\n  useEffect(() => {\n    if (`${selectedItem.id}` === `${propertyId}`) {\n      setState({\n        id: selectedItem.id,\n        bookervilleId: selectedItem.bookerville_id,\n        name: selectedItem.name,\n        category: `${selectedItem.category}`,\n        address: selectedItem.address,\n        lat: selectedItem.lat,\n        lng: selectedItem.lng,\n        description: selectedItem.description,\n        neighbourhood: selectedItem.neighbourhood,\n        transit: selectedItem.transit,\n        price: selectedItem.price,\n        minPrice: selectedItem.min_price,\n        minMonthPrice: selectedItem.min_month_price,\n        bedroomCount: selectedItem.bedroom_count,\n        bathroomCount: selectedItem.bathroom_count,\n        similarProperties: selectedItem.similar_properties,\n        sleeps: selectedItem.sleeps,\n        minSleeps: selectedItem.min_sleeps,\n        cleaningFee: selectedItem.cleaning_fee,\n        transactionFeeRate: selectedItem.transactionfee_rate,\n        taxRate: selectedItem.tax_rate,\n        refundableAmount: selectedItem.refundable_amount,\n        tour360: selectedItem.tour360,\n        furnished: renderOptionValue(selectedItem.furnished),\n        rentalParking: renderOptionValue(selectedItem.rental_parking),\n        petsConsidered: renderOptionValue(selectedItem.pets_considered),\n        rooms: selectedItem.property_rooms.map(room => ({\n          id: room.id,\n          name: room.name,\n          bedType: room.bed_type\n        })),\n        amenities: selectedItem.amenities,\n        featuredImg: selectedItem.featured_img,\n        galleryImgs: selectedItem.gallery_imgs\n      });\n    }\n  }, [selectedItem]);\n  useEffect(() => {\n    console.log(\"state\", state);\n  }, [state]);\n\n  function callback(key) {\n    console.log(key);\n  }\n\n  function handleSave() {\n    const property = {\n      id: selectedItem.id,\n      bookerville_id: state.bookervilleId,\n      name: state.name,\n      category: state.category,\n      address: state.address,\n      lat: state.lat,\n      lng: state.lng,\n      description: state.description,\n      neighbourhood: state.neighbourhood,\n      transit: state.transit,\n      price: state.price,\n      min_price: state.minPrice,\n      min_month_price: state.minMonthPrice,\n      bedroom_count: state.bedroomCount,\n      bathroom_count: state.bathroomCount,\n      similar_properties: state.similarProperties,\n      sleeps: state.sleeps,\n      min_sleeps: state.minSleeps,\n      cleaning_fee: state.cleaningFee,\n      transactionfee_rate: state.transactionFeeRate,\n      tax_rate: state.taxRate,\n      refundable_amount: state.refundableAmount,\n      tour360: state.tour360,\n      furnished: state.furnished,\n      rental_parking: state.rentalParking,\n      pets_considered: state.petsConsidered,\n      property_rooms: makeRoomsArray(),\n      amenities: state.amenities,\n      featured_img: state.featuredImg.id,\n      gallery_imgs: state.galleryImgs.map(image => image.id),\n      images: state.images\n    };\n    dispatch(propertyActions.updateProperty(property));\n  }\n\n  function handleReset() {\n    setState(_objectSpread(_objectSpread({}, state), newProperty));\n  }\n\n  function renderOptionValue(value) {\n    if (value === true) {\n      return \"1\";\n    }\n\n    return \"0\";\n  }\n\n  function makeRoomsArray() {\n    let array = state.rooms.map(room => {\n      return room.id > 10000 ? {\n        name: room.name ? room.name : \"\",\n        bed_type: room.bedType ? room.bedType : \"\"\n      } : {\n        id: room.id,\n        name: room.name ? room.name : \"\",\n        bed_type: room.bedType ? room.bedType : \"\"\n      };\n    });\n    return array;\n  }\n\n  function handlePlaceChange(place) {\n    setState(_objectSpread(_objectSpread({}, state), {}, {\n      address: place.formatted_address,\n      lat: place.geometry.location.lat(),\n      lng: place.geometry.location.lng()\n    }));\n  }\n\n  function handlePlaceReset() {\n    setState(_objectSpread(_objectSpread({}, state), {}, {\n      address: \"\",\n      lat: \"\",\n      lng: \"\"\n    }));\n  }\n\n  function handleSettingChange(changedValues, allValues) {\n    console.log(\"handleSettingChange\", changedValues, allValues);\n    setState(_objectSpread(_objectSpread({}, state), allValues));\n  }\n\n  function handleMainInfoChange(changedValues, allValues) {\n    console.log(\"handleMainInfoChange\", changedValues, allValues);\n    setState(_objectSpread(_objectSpread({}, state), allValues));\n  }\n\n  function handleToggleAmenityOption(amenityId) {\n    console.log(\"amenityId\", state.amenities, amenityId);\n    let array = state.amenities;\n    let index = array.indexOf(amenityId);\n\n    if (index > -1) {\n      array.splice(index, 1);\n      setState(_objectSpread(_objectSpread({}, state), {}, {\n        amenities: array\n      }));\n    } else {\n      array.push(amenityId);\n      setState(_objectSpread(_objectSpread({}, state), {}, {\n        amenities: array\n      }));\n    }\n\n    console.log(\"handleToggleAmenityOption\", array, state);\n  }\n\n  function handleChangeRoom(values, id) {\n    const newRooms = state.rooms.map((room, index) => {\n      if (room.id === id) {\n        return _objectSpread(_objectSpread({}, room), values);\n      }\n\n      return room;\n    });\n    console.log(\"handleChangeRoom\", newRooms);\n    setState(_objectSpread(_objectSpread({}, state), {}, {\n      rooms: newRooms\n    }));\n  }\n\n  function handleAddRoom() {\n    const generatedId = new Date().getTime();\n    console.log(\"array\", array, generatedId);\n    let array = state.rooms;\n    array.push({\n      id: generatedId,\n      name: \"\",\n      bedType: \"Q\"\n    });\n    console.log(\"handleAddRoom\", array);\n    setState(_objectSpread(_objectSpread({}, state), {}, {\n      rooms: array\n    }));\n  }\n\n  function handleRemoveRoom(roomId) {\n    console.log(\"handleRemoveRoom\", roomId);\n    let array = state.rooms;\n    let index = array.findIndex(item => item.id === roomId);\n\n    if (index > -1) {\n      array[index].name = \"\";\n      array[index].bedType = \"\";\n      setState(_objectSpread(_objectSpread({}, state), {}, {\n        rooms: array\n      }));\n    }\n  }\n\n  function handleUploadSuccess(image) {\n    const {\n      galleryImgs\n    } = state;\n    galleryImgs.push(image);\n    setState(_objectSpread(_objectSpread({}, state), {}, {\n      galleryImgs\n    }));\n  }\n\n  function handleSortEnd({\n    oldIndex,\n    newIndex\n  }) {\n    const newArray = arrayMove(state.galleryImgs, oldIndex, newIndex);\n    setState(_objectSpread(_objectSpread({}, state), {}, {\n      galleryImgs: newArray\n    }));\n  }\n\n  function handleSelectFeatured(image) {\n    setState(_objectSpread(_objectSpread({}, state), {}, {\n      featuredImg: image\n    }));\n  }\n\n  function handleSimilarPropertyChange(propertyIds) {\n    setState(_objectSpread(_objectSpread({}, state), {}, {\n      similarProperties: propertyIds\n    }));\n  }\n\n  const {\n    rowStyle,\n    colStyle\n  } = basicStyle;\n  return __jsx(LayoutWrapper, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 332,\n      columnNumber: 9\n    }\n  }, __jsx(_Row, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 333,\n      columnNumber: 13\n    }\n  }, __jsx(_Col, {\n    sm: 24,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 334,\n      columnNumber: 17\n    }\n  }, __jsx(\"div\", {\n    style: {\n      width: '100%',\n      margin: \"0 20px\",\n      background: \"#fff\",\n      padding: 20\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 335,\n      columnNumber: 21\n    }\n  }, __jsx(_Button, {\n    type: \"primary\",\n    onClick: handleSave,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 336,\n      columnNumber: 25\n    }\n  }, \"Save\"), __jsx(_Button, {\n    type: \"default\",\n    onClick: handleReset,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 339,\n      columnNumber: 25\n    }\n  }, \"Reset\")))), __jsx(_Row, {\n    style: rowStyle,\n    gutter: 0,\n    justify: \"start\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 346,\n      columnNumber: 13\n    }\n  }, __jsx(_Col, {\n    lg: 8,\n    md: 12,\n    sm: 24,\n    xs: 24,\n    style: colStyle,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 347,\n      columnNumber: 17\n    }\n  }, __jsx(\"div\", {\n    style: {\n      margin: \"0 20px\",\n      background: \"#fff\",\n      padding: 20\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 348,\n      columnNumber: 21\n    }\n  }, state.name !== \"\" && __jsx(Main, {\n    name: state.name,\n    bookervilleId: state.bookervilleId,\n    category: state.category,\n    onValuesChange: handleMainInfoChange,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 350,\n      columnNumber: 29\n    }\n  }), __jsx(Gallery, {\n    items: state.galleryImgs,\n    onSortEnd: handleSortEnd,\n    onUploadSuccess: handleUploadSuccess,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 358,\n      columnNumber: 25\n    }\n  }), __jsx(FeaturedImage, {\n    items: state.galleryImgs,\n    selectedItem: state.featuredImg,\n    onUploadSuccess: handleUploadSuccess,\n    onSelectImage: handleSelectFeatured,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 363,\n      columnNumber: 25\n    }\n  }))), __jsx(_Col, {\n    lg: 16,\n    md: 12,\n    sm: 24,\n    xs: 24,\n    style: colStyle,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 371,\n      columnNumber: 17\n    }\n  }, __jsx(Tabs, {\n    defaultActiveKey: \"1\",\n    onChange: callback,\n    style: {\n      margin: \"0 20px\",\n      background: \"#fff\",\n      padding: 20\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 372,\n      columnNumber: 21\n    }\n  }, [\"description\", \"neighbourhood\", \"transit\"].map(item => __jsx(TabPane, {\n    tab: item.charAt(0).toUpperCase() + item.slice(1),\n    key: item,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 378,\n      columnNumber: 29\n    }\n  }, (state === null || state === void 0 ? void 0 : state[item]) && __jsx(Editor, _extends({}, editorOption, {\n    html: state[item],\n    onEditorStateChange: html => setState(_objectSpread(_objectSpread({}, state), {}, {\n      [item]: html\n    })),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 383,\n      columnNumber: 37\n    }\n  })))), __jsx(TabPane, {\n    tab: \"Location\",\n    key: \"location\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 393,\n      columnNumber: 25\n    }\n  }, __jsx(Location, {\n    address: state.address,\n    center: {\n      lat: state.lat,\n      lng: state.lng\n    },\n    onPlaceChange: handlePlaceChange,\n    onReset: handlePlaceReset,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 394,\n      columnNumber: 29\n    }\n  })), __jsx(TabPane, {\n    tab: \"Setting\",\n    key: \"setting\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 404,\n      columnNumber: 25\n    }\n  }, __jsx(Setting, {\n    setting: state,\n    onValuesChange: handleSettingChange,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 405,\n      columnNumber: 29\n    }\n  })), __jsx(TabPane, {\n    tab: \"Amenity\",\n    key: \"amenity\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 407,\n      columnNumber: 25\n    }\n  }, __jsx(Amenity, {\n    amenities: state.amenities,\n    onToggleOption: handleToggleAmenityOption,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 408,\n      columnNumber: 29\n    }\n  })), __jsx(TabPane, {\n    tab: \"Bedtype\",\n    key: \"rooms\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 413,\n      columnNumber: 25\n    }\n  }, __jsx(Rooms, {\n    rooms: state.rooms,\n    onRoomChange: handleChangeRoom,\n    onAddRoom: handleAddRoom,\n    onRemoveRoom: handleRemoveRoom,\n    onValuesChange: handleSettingChange,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 414,\n      columnNumber: 29\n    }\n  })), __jsx(TabPane, {\n    tab: \"Pricing\",\n    key: \"pricing\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 422,\n      columnNumber: 25\n    }\n  }, __jsx(PricingCalendar, {\n    propertyId: propertyId,\n    defaultPrice: state.price,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 423,\n      columnNumber: 29\n    }\n  })), __jsx(TabPane, {\n    tab: \"Similar Properties\",\n    key: \"similar\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 428,\n      columnNumber: 25\n    }\n  }, __jsx(SimilarProperty, {\n    selectedItems: state.similarProperties,\n    onRowSelection: handleSimilarPropertyChange,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 429,\n      columnNumber: 29\n    }\n  }))))));\n}","map":{"version":3,"sources":["E:/Projects/starsofboston/next-django/isomorphic-next/components/Admin/Property/EditProperty.js"],"names":["React","useEffect","LayoutWrapper","Box","Tabs","TabPane","Location","basicStyle","Setting","Main","Amenity","Rooms","arrayMove","Gallery","Editor","FeaturedImage","useDispatch","useSelector","propertyActions","PricingCalendar","SimilarProperty","uploadCallback","file","Promise","resolve","reject","xhr","XMLHttpRequest","open","setRequestHeader","data","FormData","append","send","addEventListener","response","JSON","parse","responseText","error","newProperty","name","category","bookervilleId","description","neighbourhood","transit","address","lat","lng","rooms","amenities","galleryImgs","featuredImg","similarProperties","price","minPrice","minMonthPrice","bathroomCount","bedroomCount","sleeps","minSleeps","cleaningFee","transactionFeeRate","taxRate","tour360","refundableAmount","furnished","rentalParking","petsConsidered","EditProperty","props","propertyId","state","setState","useState","dispatch","selectedItem","Properties","editorOption","style","width","height","toolbarClassName","wrapperClassName","editorClassName","toolbar","image","getProperty","id","bookerville_id","min_price","min_month_price","bedroom_count","bathroom_count","similar_properties","min_sleeps","cleaning_fee","transactionfee_rate","tax_rate","refundable_amount","renderOptionValue","rental_parking","pets_considered","property_rooms","map","room","bedType","bed_type","featured_img","gallery_imgs","console","log","callback","key","handleSave","property","makeRoomsArray","images","updateProperty","handleReset","value","array","handlePlaceChange","place","formatted_address","geometry","location","handlePlaceReset","handleSettingChange","changedValues","allValues","handleMainInfoChange","handleToggleAmenityOption","amenityId","index","indexOf","splice","push","handleChangeRoom","values","newRooms","handleAddRoom","generatedId","Date","getTime","handleRemoveRoom","roomId","findIndex","item","handleUploadSuccess","handleSortEnd","oldIndex","newIndex","newArray","handleSelectFeatured","handleSimilarPropertyChange","propertyIds","rowStyle","colStyle","margin","background","padding","charAt","toUpperCase","slice","html"],"mappings":"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","sourcesContent":["import React, {useEffect} from \"react\";\r\nimport LayoutWrapper from \"@iso/components/utility/layoutWrapper\";\r\nimport Box from \"@iso/components/utility/box\";\r\nimport Tabs, {TabPane} from \"@iso/components/uielements/tabs\";\r\nimport Location from \"@components/Admin/Property/Location/Location\";\r\nimport basicStyle from \"@iso/assets/styles/constants\";\r\nimport {Row, Col, Button} from \"antd\";\r\nimport Setting from \"@components/Admin/Property/Setting/Setting\";\r\nimport Main from \"@components/Admin/Property/Main/Main\";\r\nimport Amenity from \"@components/Admin/Property/Amenity/Amenity\";\r\nimport Rooms from \"@components/Admin/Property/Room/Rooms\";\r\nimport arrayMove from \"array-move\";\r\nimport Gallery from \"@components/Admin/Property/Gallery/Gallery\";\r\nimport Editor from \"@components/Admin/Property/Editor/Editor\";\r\nimport FeaturedImage from \"@components/Admin/Property/FeaturedImage/FeaturedImage\";\r\nimport {useDispatch, useSelector} from \"react-redux\";\r\nimport propertyActions from \"@redux/properties/actions\";\r\nimport PricingCalendar from \"@components/Admin/Property/PricingCalendar/PricingCalendar\";\r\nimport SimilarProperty from \"@components/Admin/Property/SimilarProperty/SimilarProperty\";\r\n\r\nfunction uploadCallback(file) {\r\n    return new Promise((resolve, reject) => {\r\n        const xhr = new XMLHttpRequest();\r\n        xhr.open(\"POST\", \"https://api.imgur.com/3/image\");\r\n        xhr.setRequestHeader(\"Authorization\", \"Client-ID 8d26ccd12712fca\");\r\n        const data = new FormData();\r\n        data.append(\"image\", file);\r\n        xhr.send(data);\r\n        xhr.addEventListener(\"load\", () => {\r\n            const response = JSON.parse(xhr.responseText);\r\n            resolve(response);\r\n        });\r\n        xhr.addEventListener(\"error\", () => {\r\n            const error = JSON.parse(xhr.responseText);\r\n            reject(error);\r\n        });\r\n    });\r\n}\r\n\r\nconst newProperty = {\r\n    name: \"\",\r\n    category: \"\",\r\n    bookervilleId: \"\",\r\n    description: \"\",\r\n    neighbourhood: \"\",\r\n    transit: \"\",\r\n    address: \"\",\r\n    lat: \"\",\r\n    lng: \"\",\r\n    rooms: [],\r\n    amenities: [],\r\n    galleryImgs: [],\r\n    featuredImg: null,\r\n    similarProperties: [],\r\n\r\n    price: \"\",\r\n    minPrice: \"\",\r\n    minMonthPrice: \"\",\r\n    bathroomCount: \"\",\r\n    bedroomCount: \"\",\r\n    sleeps: \"\",\r\n    minSleeps: 2,\r\n    cleaningFee: \"\",\r\n    transactionFeeRate: \"\",\r\n    taxRate: \"\",\r\n    tour360: \"\",\r\n    refundableAmount: \"\",\r\n    furnished: true,\r\n    rentalParking: true,\r\n    petsConsidered: true,\r\n};\r\n\r\nexport default function EditProperty(props) {\r\n    const {propertyId} = props;\r\n    const [state, setState] = React.useState(newProperty);\r\n\r\n    const dispatch = useDispatch();\r\n    const {selectedItem} = useSelector((state) => state.Properties);\r\n    const editorOption = {\r\n        style: {width: \"90%\", height: \"70%\"},\r\n        toolbarClassName: \"home-toolbar\",\r\n        wrapperClassName: \"home-wrapper\",\r\n        editorClassName: \"home-editor\",\r\n        uploadCallback: uploadCallback,\r\n        toolbar: {image: {uploadCallback: uploadCallback}},\r\n    };\r\n\r\n    useEffect(() => {\r\n        dispatch(propertyActions.getProperty(propertyId));\r\n    }, []);\r\n\r\n    useEffect(() => {\r\n        if (`${selectedItem.id}` === `${propertyId}`) {\r\n            setState({\r\n                id: selectedItem.id,\r\n                bookervilleId: selectedItem.bookerville_id,\r\n                name: selectedItem.name,\r\n                category: `${selectedItem.category}`,\r\n                address: selectedItem.address,\r\n                lat: selectedItem.lat,\r\n                lng: selectedItem.lng,\r\n                description: selectedItem.description,\r\n                neighbourhood: selectedItem.neighbourhood,\r\n                transit: selectedItem.transit,\r\n                price: selectedItem.price,\r\n                minPrice: selectedItem.min_price,\r\n                minMonthPrice: selectedItem.min_month_price,\r\n                bedroomCount: selectedItem.bedroom_count,\r\n                bathroomCount: selectedItem.bathroom_count,\r\n                similarProperties: selectedItem.similar_properties,\r\n                sleeps: selectedItem.sleeps,\r\n                minSleeps: selectedItem.min_sleeps,\r\n                cleaningFee: selectedItem.cleaning_fee,\r\n                transactionFeeRate: selectedItem.transactionfee_rate,\r\n                taxRate: selectedItem.tax_rate,\r\n                refundableAmount: selectedItem.refundable_amount,\r\n                tour360: selectedItem.tour360,\r\n                furnished: renderOptionValue(selectedItem.furnished),\r\n                rentalParking: renderOptionValue(selectedItem.rental_parking),\r\n                petsConsidered: renderOptionValue(selectedItem.pets_considered),\r\n                rooms: selectedItem.property_rooms.map((room) => ({\r\n                    id: room.id,\r\n                    name: room.name,\r\n                    bedType: room.bed_type,\r\n                })),\r\n                amenities: selectedItem.amenities,\r\n                featuredImg: selectedItem.featured_img,\r\n                galleryImgs: selectedItem.gallery_imgs,\r\n            });\r\n        }\r\n    }, [selectedItem]);\r\n\r\n    useEffect(() => {\r\n        console.log(\"state\", state);\r\n    }, [state]);\r\n\r\n    function callback(key) {\r\n        console.log(key);\r\n    }\r\n\r\n    function handleSave() {\r\n        const property = {\r\n            id: selectedItem.id,\r\n            bookerville_id: state.bookervilleId,\r\n            name: state.name,\r\n            category: state.category,\r\n            address: state.address,\r\n            lat: state.lat,\r\n            lng: state.lng,\r\n            description: state.description,\r\n            neighbourhood: state.neighbourhood,\r\n            transit: state.transit,\r\n            price: state.price,\r\n            min_price: state.minPrice,\r\n            min_month_price: state.minMonthPrice,\r\n            bedroom_count: state.bedroomCount,\r\n            bathroom_count: state.bathroomCount,\r\n            similar_properties: state.similarProperties,\r\n            sleeps: state.sleeps,\r\n            min_sleeps: state.minSleeps,\r\n            cleaning_fee: state.cleaningFee,\r\n            transactionfee_rate: state.transactionFeeRate,\r\n            tax_rate: state.taxRate,\r\n            refundable_amount: state.refundableAmount,\r\n            tour360: state.tour360,\r\n            furnished: state.furnished,\r\n            rental_parking: state.rentalParking,\r\n            pets_considered: state.petsConsidered,\r\n            property_rooms: makeRoomsArray(),\r\n            amenities: state.amenities,\r\n            featured_img: state.featuredImg.id,\r\n            gallery_imgs: state.galleryImgs.map((image) => image.id),\r\n            images: state.images,\r\n        };\r\n        dispatch(propertyActions.updateProperty(property));\r\n    }\r\n\r\n    function handleReset() {\r\n        setState({\r\n            ...state,\r\n            ...newProperty\r\n        });\r\n    }\r\n\r\n    function renderOptionValue(value) {\r\n        if (value === true) {\r\n            return \"1\";\r\n        }\r\n        return \"0\";\r\n    }\r\n\r\n    function makeRoomsArray() {\r\n        let array = state.rooms.map((room) => {\r\n            return room.id > 10000\r\n                ? {\r\n                    name: room.name ? room.name : \"\",\r\n                    bed_type: room.bedType ? room.bedType : \"\",\r\n                }\r\n                : {\r\n                    id: room.id,\r\n                    name: room.name ? room.name : \"\",\r\n                    bed_type: room.bedType ? room.bedType : \"\",\r\n                };\r\n        });\r\n        return array;\r\n    }\r\n\r\n    function handlePlaceChange(place) {\r\n        setState({\r\n            ...state,\r\n            address: place.formatted_address,\r\n            lat: place.geometry.location.lat(),\r\n            lng: place.geometry.location.lng(),\r\n        });\r\n    }\r\n\r\n    function handlePlaceReset() {\r\n        setState({\r\n            ...state,\r\n            address: \"\",\r\n            lat: \"\",\r\n            lng: \"\",\r\n        });\r\n    }\r\n\r\n    function handleSettingChange(changedValues, allValues) {\r\n        console.log(\"handleSettingChange\", changedValues, allValues);\r\n        setState({\r\n            ...state,\r\n            ...allValues,\r\n        });\r\n    }\r\n\r\n    function handleMainInfoChange(changedValues, allValues) {\r\n        console.log(\"handleMainInfoChange\", changedValues, allValues);\r\n        setState({\r\n            ...state,\r\n            ...allValues,\r\n        });\r\n    }\r\n\r\n    function handleToggleAmenityOption(amenityId) {\r\n        console.log(\"amenityId\", state.amenities, amenityId);\r\n        let array = state.amenities;\r\n        let index = array.indexOf(amenityId);\r\n        if (index > -1) {\r\n            array.splice(index, 1);\r\n            setState({\r\n                ...state,\r\n                amenities: array,\r\n            });\r\n        } else {\r\n            array.push(amenityId);\r\n            setState({\r\n                ...state,\r\n                amenities: array,\r\n            });\r\n        }\r\n        console.log(\"handleToggleAmenityOption\", array, state);\r\n    }\r\n\r\n    function handleChangeRoom(values, id) {\r\n        const newRooms = state.rooms.map((room, index) => {\r\n            if (room.id === id) {\r\n                return {\r\n                    ...room,\r\n                    ...values,\r\n                };\r\n            }\r\n            return room;\r\n        });\r\n        console.log(\"handleChangeRoom\", newRooms);\r\n        setState({...state, rooms: newRooms});\r\n    }\r\n\r\n    function handleAddRoom() {\r\n        const generatedId = new Date().getTime();\r\n        console.log(\"array\", array, generatedId);\r\n        let array = state.rooms;\r\n        array.push({\r\n            id: generatedId,\r\n            name: \"\",\r\n            bedType: \"Q\",\r\n        });\r\n        console.log(\"handleAddRoom\", array);\r\n        setState({\r\n            ...state,\r\n            rooms: array,\r\n        });\r\n    }\r\n\r\n    function handleRemoveRoom(roomId) {\r\n        console.log(\"handleRemoveRoom\", roomId);\r\n        let array = state.rooms;\r\n        let index = array.findIndex((item) => item.id === roomId);\r\n        if (index > -1) {\r\n            array[index].name = \"\";\r\n            array[index].bedType = \"\";\r\n            setState({\r\n                ...state,\r\n                rooms: array,\r\n            });\r\n        }\r\n    }\r\n\r\n    function handleUploadSuccess(image) {\r\n        const {galleryImgs} = state;\r\n        galleryImgs.push(image);\r\n        setState({...state, galleryImgs});\r\n    }\r\n\r\n    function handleSortEnd({oldIndex, newIndex}) {\r\n        const newArray = arrayMove(state.galleryImgs, oldIndex, newIndex);\r\n\r\n        setState({\r\n            ...state,\r\n            galleryImgs: newArray,\r\n        });\r\n    }\r\n\r\n    function handleSelectFeatured(image) {\r\n        setState({...state, featuredImg: image});\r\n    }\r\n\r\n    function handleSimilarPropertyChange(propertyIds) {\r\n        setState({...state, similarProperties: propertyIds})\r\n    }\r\n\r\n    const {rowStyle, colStyle} = basicStyle;\r\n\r\n    return (\r\n        <LayoutWrapper>\r\n            <Row>\r\n                <Col sm={24}>\r\n                    <div style={{width: '100%', margin: \"0 20px\", background: \"#fff\", padding: 20}}>\r\n                        <Button type=\"primary\" onClick={handleSave}>\r\n                            Save\r\n                        </Button>\r\n                        <Button type=\"default\" onClick={handleReset}>\r\n                            Reset\r\n                        </Button>\r\n                    </div>\r\n                </Col>\r\n            </Row>\r\n\r\n            <Row style={rowStyle} gutter={0} justify=\"start\">\r\n                <Col lg={8} md={12} sm={24} xs={24} style={colStyle}>\r\n                    <div style={{margin: \"0 20px\", background: \"#fff\", padding: 20}}>\r\n                        {state.name !== \"\" && (\r\n                            <Main\r\n                                name={state.name}\r\n                                bookervilleId={state.bookervilleId}\r\n                                category={state.category}\r\n                                onValuesChange={handleMainInfoChange}\r\n                            />\r\n                        )}\r\n\r\n                        <Gallery\r\n                            items={state.galleryImgs}\r\n                            onSortEnd={handleSortEnd}\r\n                            onUploadSuccess={handleUploadSuccess}\r\n                        />\r\n                        <FeaturedImage\r\n                            items={state.galleryImgs}\r\n                            selectedItem={state.featuredImg}\r\n                            onUploadSuccess={handleUploadSuccess}\r\n                            onSelectImage={handleSelectFeatured}\r\n                        />\r\n                    </div>\r\n                </Col>\r\n                <Col lg={16} md={12} sm={24} xs={24} style={colStyle}>\r\n                    <Tabs\r\n                        defaultActiveKey=\"1\"\r\n                        onChange={callback}\r\n                        style={{margin: \"0 20px\", background: \"#fff\", padding: 20}}\r\n                    >\r\n                        {[\"description\", \"neighbourhood\", \"transit\"].map((item) => (\r\n                            <TabPane\r\n                                tab={item.charAt(0).toUpperCase() + item.slice(1)}\r\n                                key={item}\r\n                            >\r\n                                {state?.[item] && (\r\n                                    <Editor\r\n                                        {...editorOption}\r\n                                        html={state[item]}\r\n                                        onEditorStateChange={(html) =>\r\n                                            setState({...state, [item]: html})\r\n                                        }\r\n                                    />\r\n                                )}\r\n                            </TabPane>\r\n                        ))}\r\n                        <TabPane tab=\"Location\" key=\"location\">\r\n                            <Location\r\n                                address={state.address}\r\n                                center={{\r\n                                    lat: state.lat,\r\n                                    lng: state.lng,\r\n                                }}\r\n                                onPlaceChange={handlePlaceChange}\r\n                                onReset={handlePlaceReset}\r\n                            />\r\n                        </TabPane>\r\n                        <TabPane tab=\"Setting\" key=\"setting\">\r\n                            <Setting setting={state} onValuesChange={handleSettingChange}/>\r\n                        </TabPane>\r\n                        <TabPane tab=\"Amenity\" key=\"amenity\">\r\n                            <Amenity\r\n                                amenities={state.amenities}\r\n                                onToggleOption={handleToggleAmenityOption}\r\n                            />\r\n                        </TabPane>\r\n                        <TabPane tab=\"Bedtype\" key=\"rooms\">\r\n                            <Rooms\r\n                                rooms={state.rooms}\r\n                                onRoomChange={handleChangeRoom}\r\n                                onAddRoom={handleAddRoom}\r\n                                onRemoveRoom={handleRemoveRoom}\r\n                                onValuesChange={handleSettingChange}\r\n                            />\r\n                        </TabPane>\r\n                        <TabPane tab=\"Pricing\" key=\"pricing\">\r\n                            <PricingCalendar\r\n                                propertyId={propertyId}\r\n                                defaultPrice={state.price}\r\n                            />\r\n                        </TabPane>\r\n                        <TabPane tab=\"Similar Properties\" key=\"similar\">\r\n                            <SimilarProperty\r\n                                selectedItems={state.similarProperties}\r\n                                onRowSelection={handleSimilarPropertyChange}\r\n                            />\r\n                        </TabPane>\r\n                    </Tabs>\r\n                </Col>\r\n            </Row>\r\n        </LayoutWrapper>\r\n    );\r\n}\r\n"]},"metadata":{},"sourceType":"module"}